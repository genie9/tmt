<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths=".,//data/arXiv-01/0101/cs0101001/"?>
<?latexml options="11pt" class="article"?>
<?latexml options="dvips" package="graphicx"?>
<?latexml package="amssymb"?>
<?latexml package="alltt"?>
<?latexml package="afterpage"?>
<!-- %Preamble -->
<!-- %The parameter oddsidemargin (evensidemargin) is one inch -->
<!-- %less than the distance from the edge of the paper to the -->
<!-- %left margin of the text on right-hand (left-hand) pages. -->
<!-- %\setlength{\topmargin}{-0.5in} -->
<!-- %Some abbreviations -->
<!-- %**** cs0101001/ad.tex Line 25 **** -->
<!-- %\newcommand{\C}{{\raise .5ex \hbox{$ \scriptscriptstyle | $} \kern -.40em {\rm C} }} -->
<!-- %Enviroments theorem lemma and algorithm are created, and all -->
<!-- %three are numbered as in theorem. -->
<!-- %The numbering below can be done with the numinsec style -->
<!-- %provided by SIAM. -->
<!-- %The theorem numbers are defined to be of the form section#.theorem# -->
<!-- %**** cs0101001/ad.tex Line 50 **** -->
<!-- %Defines the equation number to be of the form section#.equation# -->
<!-- %\renewcommand{\theequation}{\thesection.\arabic{equation}} -->
<!-- %Defines the figure and table numbers to be of the form -->
<!-- %section#.figure# and section#.table# -->
<?latexml package="art11mod"?>
<?latexml package="numinsec"?>
<?latexml package="float"?>
<?latexml package="url"?>
<!-- %Calligraphic letter abbreviations. -->
<!-- %**** cs0101001/ad.tex Line 75 **** -->
<!-- %Abbreviations for AD. -->
<!-- %Abbreviations for software packages. -->
<!-- %**** cs0101001/ad.tex Line 100 **** -->
<!-- %Renewing commands -->
<!-- %Algorithm floating environment. -->
<?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" xml:id="oai:arXiv.org:cs0101001">
  <abstract>
    <p>We discuss the role of automatic
differentiation tools in optimization software.
We emphasize issues that are important to large-scale optimization
and that have proved useful in the installation of
nonlinear solvers in the NEOS Server.
Our discussion centers on the computation of the
gradient and Hessian matrix for partially separable functions
and shows that the gradient and Hessian matrix
can be computed with guaranteed bounds in
time and memory requirements.</p>
  </abstract>
  <ERROR class="undefined">\newfloat</ERROR>
  <para xml:id="p1">
    <p>Algorithmthploa[section]</p>
  </para>
  <para xml:id="oai:arXiv.org:cs0101001.p2">
    <p>ARGONNE NATIONAL LABORATORY</p>
  </para>
  <para xml:id="oai:arXiv.org:cs0101001.p3">
    <p>9700 South Cass Avenue</p>
  </para>
  <para xml:id="oai:arXiv.org:cs0101001.p4">
    <p>Argonne, Illinois  60439
<!-- %**** cs0101001/ad.tex Line 125 **** --></p>
  </para>
  <para xml:id="oai:arXiv.org:cs0101001.p5">
    <p><text font="bold" size="large">AUTOMATIC DIFFERENTIATION TOOLS IN OPTIMIZATION SOFTWARE
<text font="medium">
</text></text></p>
  </para>
  <para xml:id="oai:arXiv.org:cs0101001.p6">
    <p><text font="bold">Jorge J. Moré</text></p>
  </para>
  <para xml:id="oai:arXiv.org:cs0101001.p7">
    <p>Mathematics and Computer Science Division</p>
  </para>
  <para xml:id="oai:arXiv.org:cs0101001.p8">
    <p>Preprint ANL/MCS-P859-1100</p>
  </para>
  <para xml:id="oai:arXiv.org:cs0101001.p9">
    <p class="centering">November 2000</p>
    <!-- %**** cs0101001/ad.tex Line 150 **** -->
  </para>
  <para xml:id="oai:arXiv.org:cs0101001.p10">
    <p>This work was supported by the Mathematical, Information, and
Computational Sciences Division subprogram of the Office of Advanced
Scientific Computing, U.S. Department of Energy, under Contract
W-31-109-Eng-38, and
by the the National Science Foundation
(Information Technology Research) grant CCR-0082807.</p>
  </para>
  <para xml:id="oai:arXiv.org:cs0101001.p11">
    <p><text/></p>
  </para>
  <para xml:id="oai:arXiv.org:cs0101001.p12" class="centering">
    <p><text font="bold" size="large">Automatic Differentiation Tools in Optimization Software</text></p>
  </para>
  <!-- %**** cs0101001/ad.tex Line 175 **** -->
  <para xml:id="oai:arXiv.org:cs0101001.p13" class="centering">
    <p><text font="bold">Jorge J. Moré</text></p>
  </para>
  <note class="footnote">
Mathematics and Computer Science Division,
Argonne National Laboratory,
9700 South Cass Avenue,
Argonne, Illinois 60439
(<!-- %**** cs0101001/ad.tex Line 200 **** --><text font="typewriter">more@mcs.anl.gov</text>).
This work was supported by the Mathematical, Information, and
Computational Sciences Division subprogram of the Office of Advanced
Scientific Computing, U.S. Department of Energy, under Contract
W-31-109-Eng-38, and
by the the National Science Foundation
(Information Technology Research) grant CCR-0082807.
</note>
  <section refnum="1" xml:id="oai:arXiv.org:cs0101001.S1" labels="LABEL:intro">
    <title>Introduction</title>
    <para xml:id="oai:arXiv.org:cs0101001.S1.p1">
      <p>Despite advances in automatic differentiation algorithms and software,
researchers disagree on the value of incorporating
automatic differentiation tools in optimization software.
There are various reasons for this state of affairs.
An important reason seems to be that little
published experience exists on the effect of automatic differentiation
tools on realistic problems, and thus users worry that automatic
differentiations tools are not applicable to their problems or
are too expensive
in terms of time or memory.
Whatever the reasons, few optimization codes
incorporate automatic differentiation tools.
<!-- %**** cs0101001/ad.tex Line 225 **** --></p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S1.p2">
      <p>Without question, incorporating automatic differentiation
tools into optimization is not only useful but, in many cases,
essential in order to promote the widespread use of
state-of-the-art optimization software.
For example, a Newton method for the
solution of large bound-constrained problems</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S1.Ex1">
        <Math mode="display" tex="\min\left\{ f(x):x_{l}\le x\le x_{u}\right\}," xml:id="oai\@colon arXiv.org\@colon cs0101001.S1.Ex1.m1">
          <XMath>
            <XMTok meaning="minimum" role="LIMITOP" scriptpos="mid">min</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok name="colon" role="METARELOP">:</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">l</XMTok>
              </XMArg>
            </XMApp>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">u</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok role="PUNCT">,</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>where <Math mode="inline" tex="f:\mbox{${\mathbb{R}}$}^{n}\mapsto\mbox{${\mathbb{R}}$}" xml:id="oai:arXiv.org:cs0101001.S1.p2.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok name="colon" role="METARELOP">:</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S1.p2.m1.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">n</XMTok></XMArg></XMApp><XMTok meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S1.p2.m1.m2"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText></XMath></Math> and <Math mode="inline" tex="x_{l}" xml:id="oai:arXiv.org:cs0101001.S1.p2.m2"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">l</XMTok></XMArg></XMApp></XMath></Math> and <Math mode="inline" tex="x_{u}" xml:id="oai:arXiv.org:cs0101001.S1.p2.m3"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">u</XMTok></XMArg></XMApp></XMath></Math> define
the bounds on the variables, requires that the user provide
procedures for evaluating the function <Math mode="inline" tex="f(x)" xml:id="oai:arXiv.org:cs0101001.S1.p2.m4"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math> and also
the gradient <Math mode="inline" tex="\nabla f(x)" xml:id="oai:arXiv.org:cs0101001.S1.p2.m5"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math>,
the sparsity pattern of the Hessian matrix <Math mode="inline" tex="\nabla^{2}f(x)" xml:id="oai:arXiv.org:cs0101001.S1.p2.m6"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math>,
and the  Hessian matrix <Math mode="inline" tex="\nabla^{2}f(x)" xml:id="oai:arXiv.org:cs0101001.S1.p2.m7"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math>.
The demands on the user increase for the
constrained optimization problem</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S1.Ex2">
        <Math mode="display" tex="\min\left\{ f(x):x_{l}\le x\le x_{u},\  c_{l}\le c(x)\le c_{u}\right\}," xml:id="oai\@colon arXiv.org\@colon cs0101001.S1.Ex2.m1">
          <XMath>
            <XMTok meaning="minimum" role="LIMITOP" scriptpos="mid">min</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok name="colon" role="METARELOP">:</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">l</XMTok>
              </XMArg>
            </XMApp>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">u</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="PUNCT">,</XMTok>
            <XMHint name="medspace"/>
            <XMTok role="UNKNOWN" font="italic">c</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">l</XMTok>
              </XMArg>
            </XMApp>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok role="UNKNOWN" font="italic">c</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok role="UNKNOWN" font="italic">c</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">u</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok role="PUNCT">,</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>where <Math mode="inline" tex="c:\mbox{${\mathbb{R}}$}^{n}\mapsto\mbox{${\mathbb{R}}$}^{m}" xml:id="oai:arXiv.org:cs0101001.S1.p2.m8"><XMath><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok name="colon" role="METARELOP">:</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S1.p2.m8.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">n</XMTok></XMArg></XMApp><XMTok meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S1.p2.m8.m2"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">m</XMTok></XMArg></XMApp></XMath></Math> are the nonlinear constraints.
In this case the user must also provide the sparsity
pattern and the Jacobian matrix <Math mode="inline" tex="c^{{\prime}}(x)" xml:id="oai:arXiv.org:cs0101001.S1.p2.m9"><XMath><XMTok role="UNKNOWN" font="italic">c</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math>
of the constraints. In some cases the user may even be asked
<!-- %**** cs0101001/ad.tex Line 250 **** -->to provide the Hessian matrix of the Lagrangian</p>
      <equation refnum="1" xml:id="oai\@colon arXiv.org\@colon cs0101001.S1.E1" labels="LABEL:intro:lagrangian">
        <Math mode="display" tex="L(x,u)=f(x)+\langle u,c(x)\rangle" xml:id="oai\@colon arXiv.org\@colon cs0101001.S1.E1.m1">
          <XMath>
            <XMTok role="UNKNOWN" font="italic">L</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="PUNCT">,</XMTok>
            <XMTok role="UNKNOWN" font="italic">u</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok meaning="plus" role="ADDOP">+</XMTok>
            <XMTok name="langle" role="OPEN">〈</XMTok>
            <XMTok role="UNKNOWN" font="italic">u</XMTok>
            <XMTok role="PUNCT">,</XMTok>
            <XMTok role="UNKNOWN" font="italic">c</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok name="rangle" role="CLOSE">〉</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>of the optimization problem.
The time and effort required to obtain this information and
verify their correctness can be large even for simple
problems. Clearly, any help in simplifying this effort
would promote the use of the software.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S1.p3">
      <p>In spite of the advantages offered by automatic
differentiation tools, relatively little effort
has been made to interface optimization software with automatic
differentiation tools.
Dixon <cite>[<bibref bibrefs="dixon1991a,dixon1991b" separator="," show="Number" yyseparator=","/>]</cite> was an early proponent
of the integration of automatic differentiation with optimization,
but to our knowledge
Liu and Tits <cite>[<bibref bibrefs="liutits1997" separator="," show="Number" yyseparator=","/>]</cite> were the
first to provide interfaces between a general nonlinear
constrained optimization solver (<text><text font="sansserif" size="footnote">FSQP</text></text>) and automatic
differentiation tools (ADIFOR).</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S1.p4">
      <p>Modeling languages for optimization (for example,
AMPL <cite>[<bibref bibrefs="ampl-home" separator="," show="Number" yyseparator=","/>]</cite> and
<!-- %**** cs0101001/ad.tex Line 275 **** -->GAMS <cite>[<bibref bibrefs="gams-home" separator="," show="Number" yyseparator=","/>]</cite>) provide environments for solving
optimization problems that deserve emulation.
These environments package the ability to calculate derivatives,
together with state-of-the-art optimization solvers and
a language that facilitates modeling, to yield an extremely
attractive problem-solving environment.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S1.p5">
      <p>The NEOS Server for Optimization <cite>[<bibref bibrefs="neos-home" separator="," show="Number" yyseparator=","/>]</cite> is another
problem-solving environment that integrates automatic differentiation
tools and state-of-the-art optimization solvers.  Users choose a solver
and submit problems via the Web, email (<ref class="url" href="neos@mcs.anl.gov"><text font="typewriter">neos@mcs.anl.gov</text></ref>), or a
Java-enabled submission tool. When a submission arrives, NEOS parses
the submission data and relays that data to a computer associated with
the solver. Once results are obtained, they are sent to NEOS, which
returns the results to the user. Submissions specified in Fortran
are processed by ADIFOR <cite>[<bibref bibrefs="adifor2,adifor2-revc" separator="," show="Number" yyseparator=","/>]</cite>,
while C submissions are handled
by ADOL-C <cite>[<bibref bibrefs="adol-c" separator="," show="Number" yyseparator=","/>]</cite>.
Since the initial release in 1995, the NEOS Server has continued
to add nonlinear optimization solvers with an emphasis on
large-scale problems, and the current version contains
more than a dozen different nonlinear optimization solvers.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S1.p6">
      <p>Users of a typical computing
environment would like to solve optimization problems
<!-- %**** cs0101001/ad.tex Line 300 **** -->while only requiring that the user provide a specification
of the problem; all other quantities required by the software (for
example, gradients, Hessians, and sparsity patterns) would be generated automatically.
Optimization modeling languages and the NEOS Server provide this
ability, but as noted above, users of nonlinear optimization solvers
are usually asked to provide derivative information.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S1.p7">
      <p>Our goal in this paper is to discuss techniques for using automatic
differentiation tools in large-scale optimization software.
We highlight issues that are relevant to solvers in the
NEOS Server. For recent work on the interface between automatic differentiation
tools and large-scale solvers, see
<cite>[<bibref bibrefs="ad2k-ja00,ad2k-pdh00" separator="," show="Number" yyseparator=","/>]</cite>.
We pay particular attention to the computation of
second-order (Hessian) information since there is evidence
that the use of second-order information is crucial
to the solution of large-scale problems. The main concern is
the cost of obtaining second-order information.
See <cite>[<bibref bibrefs="ja97,rg00,ag00" separator="," show="Number" yyseparator=","/>]</cite> for related work.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S1.p8">
      <p>We note that at present most optimization software for large-scale
problems use only first-order derivatives.
Indeed, of the nonlinear solvers available in the
NEOS Server, only <text><text font="sansserif" size="footnote">LANCELOT</text></text>, <text><text font="sansserif" size="footnote">LOQO</text></text>, and <text><text font="sansserif" size="footnote">TRON</text></text> accept second-order
information. We expect this situation to change, however, as automatic
<!-- %**** cs0101001/ad.tex Line 325 **** -->differentiation tools improve and provide
second-order information with the same reliability and
efficiency as are currently available for first-order information.</p>
    </para>
  </section>
  <section refnum="2" xml:id="oai:arXiv.org:cs0101001.S2">
    <title>Partially Separable Functions</title>
    <para xml:id="oai:arXiv.org:cs0101001.S2.p1">
      <p>We consider the computation of the gradient and Hessian
matrix of a partially
separable function, that is, a function
<Math mode="inline" tex="f:\mbox{${\mathbb{R}}$}^{n}\mapsto\mbox{${\mathbb{R}}$}" xml:id="oai:arXiv.org:cs0101001.S2.p1.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok name="colon" role="METARELOP">:</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S2.p1.m1.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">n</XMTok></XMArg></XMApp><XMTok meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S2.p1.m1.m2"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText></XMath></Math> of the form</p>
      <equation refnum="2" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E2" labels="LABEL:psf:decomposition">
        <Math mode="display" tex="f(x)=\sum _{{k=1}}^{m}f_{k}(x)," xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E2.m1">
          <XMath>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMTok meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">k</XMTok>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMArg>
            </XMApp>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="2">
              <XMArg rule="Superscript">
                <XMTok role="UNKNOWN" font="italic">m</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">k</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="PUNCT">,</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>where the component functions <Math mode="inline" tex="f_{k}:\mbox{${\mathbb{R}}$}^{n}\mapsto\mbox{${\mathbb{R}}$}" xml:id="oai:arXiv.org:cs0101001.S2.p1.m2"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">k</XMTok></XMArg></XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S2.p1.m2.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">n</XMTok></XMArg></XMApp><XMTok meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S2.p1.m2.m2"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText></XMath></Math> are
such that the <text font="italic">extended</text> function</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.Ex3">
        <Math mode="display" tex="\mbox{$f_{{\scriptscriptstyle E}}$}(x)=\left(\begin{array}[]{c}f_{1}(x)\\&#10;\vdots\\&#10;f_{m}(x)\end{array}\right)" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.Ex3.m1">
          <XMath>
            <XMText>
              <text>
                <Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.Ex3.m1.m1">
                  <XMath>
                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">E</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMArray role="ARRAY">
              <XMRow>
                <XMCell align="center">
                  <XMArg rule="Anything,">
                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="8">
                      <XMArg rule="Subscript">
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMArg>
                    </XMApp>
                    <XMTok role="OPEN">(</XMTok>
                    <XMTok role="UNKNOWN" font="italic">x</XMTok>
                    <XMTok role="CLOSE">)</XMTok>
                  </XMArg>
                </XMCell>
              </XMRow>
              <XMRow>
                <XMCell align="center">
                  <XMArg rule="Anything,">
                    <XMTok name="vdots" role="ID">⋮</XMTok>
                  </XMArg>
                </XMCell>
              </XMRow>
              <XMRow>
                <XMCell align="center">
                  <XMArg rule="Anything,">
                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="8">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">m</XMTok>
                      </XMArg>
                    </XMApp>
                    <XMTok role="OPEN">(</XMTok>
                    <XMTok role="UNKNOWN" font="italic">x</XMTok>
                    <XMTok role="CLOSE">)</XMTok>
                  </XMArg>
                </XMCell>
              </XMRow>
            </XMArray>
            <!-- %**** cs0101001/ad.tex Line 350 **** -->
            <XMTok role="CLOSE">)</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>has a sparse Jacobian matrix. Our techniques are geared to
the solution of large-scale optimization problems.
For an extensive treatment of techniques for computing
derivatives of general and partially separable functions
with automatic differentiation tools,
we recommend the recent book by Griewank <cite>[<bibref bibrefs="ag00" separator="," show="Number" yyseparator=","/>]</cite>.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S2.p2">
      <p>Partially separable
functions were introduced by Griewank and Toint <cite>[<bibref bibrefs="ag82a" separator="," show="Number" yyseparator=","/>]</cite>.
They showed, in particular, that
<Math mode="inline" tex="f:\mbox{${\mathbb{R}}$}^{n}\mapsto\mbox{${\mathbb{R}}$}" xml:id="oai:arXiv.org:cs0101001.S2.p2.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok name="colon" role="METARELOP">:</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S2.p2.m1.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">n</XMTok></XMArg></XMApp><XMTok meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S2.p2.m1.m2"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText></XMath></Math> is partially
separable if and only if the Hessian matrix <Math mode="inline" tex="\nabla^{2}f(x)" xml:id="oai:arXiv.org:cs0101001.S2.p2.m2"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math> is sparse.
<!-- %For additional information, see Griewank [Section 92] \cite{AG00}. -->Partially separable functions also arise
in systems of nonlinear equations and nonlinear least
squares problems. For example, if each component of the mapping
<Math mode="inline" tex="r:\mbox{${\mathbb{R}}$}^{n}\mapsto\mbox{${\mathbb{R}}$}^{m}" xml:id="oai:arXiv.org:cs0101001.S2.p2.m3"><XMath><XMTok role="UNKNOWN" font="italic">r</XMTok><XMTok name="colon" role="METARELOP">:</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S2.p2.m3.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">n</XMTok></XMArg></XMApp><XMTok meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S2.p2.m3.m2"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">m</XMTok></XMArg></XMApp></XMath></Math> is partially separable, then</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.Ex4">
        <Math mode="display" tex="f(x)={\textstyle{\frac{1}{2}}}\| r(x)\|^{2}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.Ex4.m1">
          <XMath>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMApp>
              <XMTok meaning="divide" role="MULOP" style="text"/>
              <XMArg>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMArg>
              <XMArg>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMArg>
            </XMApp>
            <XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok>
            <XMTok role="UNKNOWN" font="italic">r</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="2">
              <XMArg rule="Superscript">
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMArg>
            </XMApp>
          </XMath>
        </Math>
      </equation>
      <p>is also partially separable. As another example, consider the
constrained optimization problem</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.Ex5">
        <Math mode="display" tex="\min\left\{ f(x):x_{l}\le x\le x_{u},\  c_{l}\le c(x)\le c_{u}\right\}," xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.Ex5.m1">
          <XMath>
            <!-- %**** cs0101001/ad.tex Line 375 **** -->
            <XMTok meaning="minimum" role="LIMITOP" scriptpos="mid">min</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok name="colon" role="METARELOP">:</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">l</XMTok>
              </XMArg>
            </XMApp>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">u</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="PUNCT">,</XMTok>
            <XMHint name="medspace"/>
            <XMTok role="UNKNOWN" font="italic">c</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">l</XMTok>
              </XMArg>
            </XMApp>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok role="UNKNOWN" font="italic">c</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok role="UNKNOWN" font="italic">c</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">u</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok role="PUNCT">,</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>where
<Math mode="inline" tex="c:\mbox{${\mathbb{R}}$}^{n}\mapsto\mbox{${\mathbb{R}}$}^{m}" xml:id="oai:arXiv.org:cs0101001.S2.p2.m4"><XMath><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok name="colon" role="METARELOP">:</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S2.p2.m4.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">n</XMTok></XMArg></XMApp><XMTok meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S2.p2.m4.m2"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">m</XMTok></XMArg></XMApp></XMath></Math> specifies the constraints.
For this problem, the Lagrangian function <Math mode="inline" tex="L(\cdot,u)" xml:id="oai:arXiv.org:cs0101001.S2.p2.m5"><XMath><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="OPEN">(</XMTok><XMTok name="cdot" role="MULOP">⋅</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">u</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math> defined
by <text>(<ref labelref="LABEL:intro:lagrangian"/>)</text>
is partially separable if <Math mode="inline" tex="f" xml:id="oai:arXiv.org:cs0101001.S2.p2.m6"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math> and all the components of
the mapping <Math mode="inline" tex="c" xml:id="oai:arXiv.org:cs0101001.S2.p2.m7"><XMath><XMTok role="UNKNOWN" font="italic">c</XMTok></XMath></Math> are partially separable.
For specific examples note that the functions
<Math mode="inline" tex="f" xml:id="oai:arXiv.org:cs0101001.S2.p2.m8"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math> and <Math mode="inline" tex="c" xml:id="oai:arXiv.org:cs0101001.S2.p2.m9"><XMath><XMTok role="UNKNOWN" font="italic">c</XMTok></XMath></Math> in the parameter estimation
and optimal control optimization problems in the <text><text font="sansserif" size="footnote">COPS</text></text> <cite>[<bibref bibrefs="edd00" separator="," show="Number" yyseparator=","/>]</cite>
collection are partially separable.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S2.p3">
      <p>We are interested in computing
the gradient and the Hessian of a partially
separable function with guaranteed bounds in terms of both computing
time and memory requirements. We require that the computing time
be bounded by a multiple of the computing time of the function,
that is,</p>
      <equation refnum="3" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E3" labels="LABEL:psf:ctime">
        <Math mode="display" tex="T\{\nabla f(x)\}\le\mbox{$\Omega _{{\scriptscriptstyle T,G}}$}\, T\{ f(x)\},\qquad T\{\nabla^{2}f(x)\}\le\mbox{$\Omega _{{\scriptscriptstyle T,H}}$}\, T\{ f(x)\}," xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E3.m1">
          <XMath>
            <XMTok role="UNKNOWN" font="italic">T</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok name="nabla" role="OPERATOR">∇</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMText>
              <text>
                <Math mode="inline" tex="\Omega _{{\scriptscriptstyle T,G}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E3.m1.m1">
                  <XMath>
                    <XMTok name="Omega" role="UNKNOWN">Ω</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">T</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok role="UNKNOWN" font="italic">G</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMHint name="thinspace"/>
            <XMTok role="UNKNOWN" font="italic">T</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok role="PUNCT">,</XMTok>
            <XMHint name="qquad"/>
            <XMTok role="UNKNOWN" font="italic">T</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok name="nabla" role="OPERATOR">∇</XMTok>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="2">
              <XMArg rule="Superscript">
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMText>
              <text>
                <Math mode="inline" tex="\Omega _{{\scriptscriptstyle T,H}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E3.m1.m2">
                  <XMath>
                    <XMTok name="Omega" role="UNKNOWN">Ω</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">T</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok role="UNKNOWN" font="italic">H</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMHint name="thinspace"/>
            <XMTok role="UNKNOWN" font="italic">T</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok role="PUNCT">,</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>for constants
<!-- %**** cs0101001/ad.tex Line 400 **** --><text><Math mode="inline" tex="\Omega _{{\scriptscriptstyle T,G}}" xml:id="oai:arXiv.org:cs0101001.S2.p3.m1.m1"><XMath><XMTok name="Omega" role="UNKNOWN">Ω</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">T</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">G</XMTok></XMArg></XMApp></XMath></Math></text> and <text><Math mode="inline" tex="\Omega _{{\scriptscriptstyle T,H}}" xml:id="oai:arXiv.org:cs0101001.S2.p3.m2.m1"><XMath><XMTok name="Omega" role="UNKNOWN">Ω</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">T</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">H</XMTok></XMArg></XMApp></XMath></Math></text>,
where <Math mode="inline" tex="T\{\cdot\}" xml:id="oai:arXiv.org:cs0101001.S2.p3.m3"><XMath><XMTok role="UNKNOWN" font="italic">T</XMTok><XMTok role="OPEN" font="italic">{</XMTok><XMTok name="cdot" role="MULOP">⋅</XMTok><XMTok role="CLOSE" font="italic">}</XMTok></XMath></Math> is computing time.
We also require that</p>
      <equation refnum="4" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E4" labels="LABEL:psf:cmem">
        <Math mode="display" tex="M\{\nabla f(x)\}\le\mbox{$\Omega _{{\scriptscriptstyle M,G}}$}\, M\{ f(x)\},\qquad M\{\nabla^{2}f(x)\}\le\mbox{$\Omega _{{\scriptscriptstyle M,H}}$}\, M\{ f(x)\}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E4.m1">
          <XMath>
            <XMTok role="UNKNOWN" font="italic">M</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok name="nabla" role="OPERATOR">∇</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMText>
              <text>
                <Math mode="inline" tex="\Omega _{{\scriptscriptstyle M,G}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E4.m1.m1">
                  <XMath>
                    <XMTok name="Omega" role="UNKNOWN">Ω</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">M</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok role="UNKNOWN" font="italic">G</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMHint name="thinspace"/>
            <XMTok role="UNKNOWN" font="italic">M</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok role="PUNCT">,</XMTok>
            <XMHint name="qquad"/>
            <XMTok role="UNKNOWN" font="italic">M</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok name="nabla" role="OPERATOR">∇</XMTok>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="2">
              <XMArg rule="Superscript">
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMText>
              <text>
                <Math mode="inline" tex="\Omega _{{\scriptscriptstyle M,H}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E4.m1.m2">
                  <XMath>
                    <XMTok name="Omega" role="UNKNOWN">Ω</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">M</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok role="UNKNOWN" font="italic">H</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMHint name="thinspace"/>
            <XMTok role="UNKNOWN" font="italic">M</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>for constants
<text><Math mode="inline" tex="\Omega _{{\scriptscriptstyle M,G}}" xml:id="oai:arXiv.org:cs0101001.S2.p3.m4.m1"><XMath><XMTok name="Omega" role="UNKNOWN">Ω</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">G</XMTok></XMArg></XMApp></XMath></Math></text> and <text><Math mode="inline" tex="\Omega _{{\scriptscriptstyle M,H}}" xml:id="oai:arXiv.org:cs0101001.S2.p3.m5.m1"><XMath><XMTok name="Omega" role="UNKNOWN">Ω</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">H</XMTok></XMArg></XMApp></XMath></Math></text>, where
<Math mode="inline" tex="M\{\cdot\}" xml:id="oai:arXiv.org:cs0101001.S2.p3.m6"><XMath><XMTok role="UNKNOWN" font="italic">M</XMTok><XMTok role="OPEN" font="italic">{</XMTok><XMTok name="cdot" role="MULOP">⋅</XMTok><XMTok role="CLOSE" font="italic">}</XMTok></XMath></Math> is memory.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S2.p4">
      <p>These are important requirements for large-scale problems.
In particular, if the constants in these expressions
are small and independent of the structure of the
extended function <text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S2.p4.m1.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text>,
then the computational requirements of an iteration of Newton's
method are comparable with those of a limited-memory Newton's
method.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S2.p5">
      <p>The constants in <text>(<ref labelref="LABEL:psf:ctime"/>)</text> and <text>(<ref labelref="LABEL:psf:cmem"/>)</text>
can be bounded in terms of a measure of the sparsity of the
extended function. We use <text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S2.p5.m1.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text>, where</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.Ex6">
        <Math mode="display" tex="\mbox{$\rho _{{\scriptscriptstyle M}}$}\equiv\max\{\rho _{i}\}," xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.Ex6.m1">
          <XMath>
            <XMText>
              <text>
                <Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.Ex6.m1.m1">
                  <XMath>
                    <XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">M</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok meaning="identical-to" name="equiv" role="RELOP">≡</XMTok>
            <XMTok meaning="maximum" role="LIMITOP" scriptpos="mid">max</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">i</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok role="PUNCT">,</XMTok>
            <!-- %**** cs0101001/ad.tex Line 425 **** -->
          </XMath>
        </Math>
      </equation>
      <p>and <Math mode="inline" tex="\rho _{i}" xml:id="oai:arXiv.org:cs0101001.S2.p5.m2"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">i</XMTok></XMArg></XMApp></XMath></Math> is the number of nonzeros in the
<Math mode="inline" tex="i" xml:id="oai:arXiv.org:cs0101001.S2.p5.m3"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>th row of <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)" xml:id="oai:arXiv.org:cs0101001.S2.p5.m4"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S2.p5.m4.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math>. We can also view <text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S2.p5.m5.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text> as the
largest number of variables in any of the component functions.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S2.p6">
      <p>Decompositions <text>(<ref labelref="LABEL:psf:decomposition"/>)</text>
with the number <Math mode="inline" tex="m" xml:id="oai:arXiv.org:cs0101001.S2.p6.m1"><XMath><XMTok role="UNKNOWN" font="italic">m</XMTok></XMath></Math>
of element functions of order <Math mode="inline" tex="n" xml:id="oai:arXiv.org:cs0101001.S2.p6.m2"><XMath><XMTok role="UNKNOWN" font="italic">n</XMTok></XMath></Math>,
and with <text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S2.p6.m3.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text> small and independent of <Math mode="inline" tex="n" xml:id="oai:arXiv.org:cs0101001.S2.p6.m4"><XMath><XMTok role="UNKNOWN" font="italic">n</XMTok></XMath></Math>,
are preferred.
Since the number of nonzeros in
the Hessian <Math mode="inline" tex="\nabla^{2}f(x)" xml:id="oai:arXiv.org:cs0101001.S2.p6.m5"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math> is no more than <Math mode="inline" tex="m\mbox{$\rho _{{\scriptscriptstyle M}}$}" xml:id="oai:arXiv.org:cs0101001.S2.p6.m6"><XMath><XMTok role="UNKNOWN" font="italic">m</XMTok><XMText><text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S2.p6.m6.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text></XMText></XMath></Math>,
decompositions with these properties
are guaranteed to have sparse Hessian matrices.
Discretizations of parameter estimation and optimal control problems,
for example, have these properties because in these problems each element
function represents the contributions from an interval or an element
in the discretization.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S2.p7">
      <p>One of the aims of this paper is to present numerical evidence
that we can compute the
gradient <Math mode="inline" tex="\nabla f(x)" xml:id="oai:arXiv.org:cs0101001.S2.p7.m1"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math> and the Hessian matrix
<Math mode="inline" tex="\nabla^{2}f(x)" xml:id="oai:arXiv.org:cs0101001.S2.p7.m2"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math> of a partially
separable function with</p>
      <equation refnum="5" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E5" labels="LABEL:psf:bound">
        <Math mode="display" tex="\mbox{$\Omega _{{\scriptscriptstyle T,G}}$}\le\kappa _{1}\mbox{$\rho _{{\scriptscriptstyle M}}$},\qquad\mbox{$\Omega _{{\scriptscriptstyle T,H}}$}\le\kappa _{2}\mbox{$\rho _{{\scriptscriptstyle M}}^{2}$}," xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E5.m1">
          <XMath>
            <!-- %**** cs0101001/ad.tex Line 450 **** -->
            <XMText>
              <text>
                <Math mode="inline" tex="\Omega _{{\scriptscriptstyle T,G}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E5.m1.m1">
                  <XMath>
                    <XMTok name="Omega" role="UNKNOWN">Ω</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">T</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok role="UNKNOWN" font="italic">G</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMArg>
            </XMApp>
            <XMText>
              <text>
                <Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E5.m1.m2">
                  <XMath>
                    <XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">M</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok role="PUNCT">,</XMTok>
            <XMHint name="qquad"/>
            <XMText>
              <text>
                <Math mode="inline" tex="\Omega _{{\scriptscriptstyle T,H}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E5.m1.m3">
                  <XMath>
                    <XMTok name="Omega" role="UNKNOWN">Ω</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">T</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok role="UNKNOWN" font="italic">H</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMArg>
            </XMApp>
            <XMText>
              <text>
                <Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}^{2}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S2.E5.m1.m4">
                  <XMath>
                    <XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">M</XMTok>
                      </XMArg>
                    </XMApp>
                    <XMApp role="POSTSUPERSCRIPT" scriptpos="4">
                      <XMArg rule="Superscript">
                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok role="PUNCT">,</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>where <Math mode="inline" tex="\kappa _{1}" xml:id="oai:arXiv.org:cs0101001.S2.p7.m3"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="1" role="NUMBER">1</XMTok></XMArg></XMApp></XMath></Math> and <Math mode="inline" tex="\kappa _{2}" xml:id="oai:arXiv.org:cs0101001.S2.p7.m4"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp></XMath></Math> are constants of modest size
and independent of <text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S2.p7.m5.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text>. We normalize
<text><Math mode="inline" tex="\Omega _{{\scriptscriptstyle T,G}}" xml:id="oai:arXiv.org:cs0101001.S2.p7.m6.m1"><XMath><XMTok name="Omega" role="UNKNOWN">Ω</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">T</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">G</XMTok></XMArg></XMApp></XMath></Math></text> by <text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S2.p7.m7.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text> because the techniques in Section <ref labelref="LABEL:sec:gradients"/>
require at least <text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S2.p7.m8.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text> functions evaluations to
estimate the gradient.
Similarly, the number of gradient evaluations needed to estimate
the Hessian matrix by the techniques in Section <ref labelref="LABEL:sec:hessians"/>
is at least <text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S2.p7.m9.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text>. Thus, these techniques require
at least <text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}^{2}" xml:id="oai:arXiv.org:cs0101001.S2.p7.m10.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp><XMApp role="POSTSUPERSCRIPT" scriptpos="4"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp></XMath></Math></text> function
evaluations to estimate the Hessian matrix.</p>
    </para>
  </section>
  <section refnum="3" xml:id="oai:arXiv.org:cs0101001.S3" labels="LABEL:sec:gradients">
    <title>Computing Gradients</title>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p1">
      <p>We now outline the techniques that we use for computing the
gradients of partially separable functions.
For additional information on
the techniques in this section, see
<cite>[<bibref bibrefs="bouaricha94,b95fa" separator="," show="Number" yyseparator=","/>]</cite>.
<!-- %**** cs0101001/ad.tex Line 475 **** --></p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p2">
      <p>Computing the gradient of a partially separable function
so that the bounds <text>(<ref labelref="LABEL:psf:ctime"/>)</text> and <text>(<ref labelref="LABEL:psf:cmem"/>)</text>
are satisfied is based on the observation, due to
Andreas Griewank, that
if <Math mode="inline" tex="f:\mbox{${\mathbb{R}}$}^{n}\to\mbox{${\mathbb{R}}$}" xml:id="oai:arXiv.org:cs0101001.S3.p2.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok name="colon" role="METARELOP">:</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S3.p2.m1.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">n</XMTok></XMArg></XMApp><XMTok name="to" role="ARROW">→</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S3.p2.m1.m2"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText></XMath></Math> is partially separable, then</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S3.Ex7">
        <Math mode="display" tex="f(x)=\mbox{$f_{{\scriptscriptstyle E}}$}(x)^{T}e," xml:id="oai\@colon arXiv.org\@colon cs0101001.S3.Ex7.m1">
          <XMath>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMText>
              <text>
                <Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S3.Ex7.m1.m1">
                  <XMath>
                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">E</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="2">
              <XMArg rule="Superscript">
                <XMTok role="UNKNOWN" font="italic">T</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="UNKNOWN" font="italic">e</XMTok>
            <XMTok role="PUNCT">,</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>where <Math mode="inline" tex="e\in\mbox{${\mathbb{R}}$}^{m}" xml:id="oai:arXiv.org:cs0101001.S3.p2.m2"><XMath><XMTok role="UNKNOWN" font="italic">e</XMTok><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S3.p2.m2.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">m</XMTok></XMArg></XMApp></XMath></Math> is the vector of all ones, and hence</p>
      <equation refnum="6" xml:id="oai\@colon arXiv.org\@colon cs0101001.S3.E6" labels="LABEL:grads:psf">
        <Math mode="display" tex="\nabla f(x)=\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)^{T}e." xml:id="oai\@colon arXiv.org\@colon cs0101001.S3.E6.m1">
          <XMath>
            <XMTok name="nabla" role="OPERATOR">∇</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMText>
              <text>
                <Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S3.E6.m1.m1">
                  <XMath>
                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">E</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="2">
              <XMArg rule="Superscript">
                <XMTok name="prime" role="SUPOP">′</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="2">
              <XMArg rule="Superscript">
                <XMTok role="UNKNOWN" font="italic">T</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="UNKNOWN" font="italic">e</XMTok>
            <XMTok role="PERIOD">.</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>We can then compute the gradient by computing the
Jacobian matrix <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)" xml:id="oai:arXiv.org:cs0101001.S3.p2.m3"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S3.p2.m3.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math>.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p3">
      <p>At first sight the approach based on <text>(<ref labelref="LABEL:grads:psf"/>)</text> does not look
promising, since we need to compute a Jacobian matrix and then
obtain the gradient from a matrix-vector product.  However, the key
observation is that the Jacobian matrix is sparse, while the
gradient is dense. Thus, we can use sparse techniques for
the computation of the extended Jacobian.</p>
    </para>
    <!-- %This approach was 
     %**** cs0101001/ad.tex Line 500 ****
     %suggested by Griewank, and can be viewed as a special case of the
     %results in Griewank \cite[Section 2]{AG93}.-->
    <para xml:id="oai:arXiv.org:cs0101001.S3.p4">
      <p>We could also use the reverse approach
<!-- %(Griewank \cite[Chapters 3-4]{AG00}) -->of automatic differentiation
to compute the gradient of <Math mode="inline" tex="f" xml:id="oai:arXiv.org:cs0101001.S3.p4.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math>. The reverse approach works
directly on <Math mode="inline" tex="f" xml:id="oai:arXiv.org:cs0101001.S3.p4.m2"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math> and does not require the partial separability
structure of <Math mode="inline" tex="f" xml:id="oai:arXiv.org:cs0101001.S3.p4.m3"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math>. Moreover, for the reverse approach,
<text>(<ref labelref="LABEL:psf:ctime"/>)</text> holds with <text><Math mode="inline" tex="\Omega _{{\scriptscriptstyle T,G}}" xml:id="oai:arXiv.org:cs0101001.S3.p4.m4.m1"><XMath><XMTok name="Omega" role="UNKNOWN">Ω</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">T</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">G</XMTok></XMArg></XMApp></XMath></Math></text> small and independent
of <text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S3.p4.m5.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text>. Theoretically <Math mode="inline" tex="\mbox{$\Omega _{{\scriptscriptstyle T,G}}$}\le 5" xml:id="oai:arXiv.org:cs0101001.S3.p4.m6"><XMath><XMText><text><Math mode="inline" tex="\Omega _{{\scriptscriptstyle T,G}}" xml:id="oai:arXiv.org:cs0101001.S3.p4.m6.m1"><XMath><XMTok name="Omega" role="UNKNOWN">Ω</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">T</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">G</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok><XMTok meaning="5" role="NUMBER">5</XMTok></XMath></Math>, but practical
implementations may not satisfy this bound.
However, the memory requirements of the reverse approach
depend on the number of floating point operations needed
to compute <Math mode="inline" tex="f" xml:id="oai:arXiv.org:cs0101001.S3.p4.m7"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math>, and thus <text>(<ref labelref="LABEL:psf:cmem"/>)</text> can be violated.
A careful comparison between the reverse approach and the
techniques described below would be of interest.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p5">
      <p>In this section we consider two
methods for computing the gradient of a partially separable function
via <text>(<ref labelref="LABEL:grads:psf"/>)</text>. In the <text font="italic">compressed</text> AD approach, automatic
differentiation tools are used to compute a
compressed form of the Jacobian matrix of the extended function
<text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S3.p5.m1.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text>, while in
the <text font="italic">sparse</text> AD approach, automatic differentiation tools
<!-- %**** cs0101001/ad.tex Line 525 **** -->are used to compute a sparse representation of the Jacobian
matrix  of the extended function.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p6">
      <p>In the compressed AD approach we assume that the sparsity
pattern of the Jacobian matrix <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)" xml:id="oai:arXiv.org:cs0101001.S3.p6.m1"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S3.p6.m1.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math> is known.
Given the sparsity pattern, we
partition the columns of the Jacobian matrix into groups of
<text font="italic">structurally orthogonal</text> columns, that is,
columns that do not have a nonzero in
the same row position.
Given a partitioning of the columns into <Math mode="inline" tex="p" xml:id="oai:arXiv.org:cs0101001.S3.p6.m2"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok></XMath></Math>
groups of structurally orthogonal columns,
we determine  the Jacobian matrix by
computing the <text font="italic">compressed Jacobian</text> matrix <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)V" xml:id="oai:arXiv.org:cs0101001.S3.p6.m3"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S3.p6.m3.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok><XMTok role="UNKNOWN" font="italic">V</XMTok></XMath></Math>,
where <Math mode="inline" tex="V\in\mbox{${\mathbb{R}}$}^{{n\times p}}" xml:id="oai:arXiv.org:cs0101001.S3.p6.m4"><XMath><XMTok role="UNKNOWN" font="italic">V</XMTok><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S3.p6.m4.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok meaning="times" role="MULOP">×</XMTok><XMTok role="UNKNOWN" font="italic">p</XMTok></XMArg></XMApp></XMath></Math>.
There is a column of <Math mode="inline" tex="V" xml:id="oai:arXiv.org:cs0101001.S3.p6.m5"><XMath><XMTok role="UNKNOWN" font="italic">V</XMTok></XMath></Math> for each group, and
<Math mode="inline" tex="v_{{i,j}}\neq 0" xml:id="oai:arXiv.org:cs0101001.S3.p6.m6"><XMath><XMTok role="UNKNOWN" font="italic">v</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMArg></XMApp><XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMath></Math> only if the <text font="italic">i</text>th column of
<Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)" xml:id="oai:arXiv.org:cs0101001.S3.p6.m7"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S3.p6.m7.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math> is in the
<text font="italic">j</text>th group.
Software for this partitioning problem <cite>[<bibref bibrefs="tfc84" separator="," show="Number" yyseparator=","/>]</cite> defines the
groups with an array
<text font="typewriter">ngrp</text> that sets the group for each column.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p7">
      <p>The extended Jacobian can be determined from the compressed
Jacobian matrix  <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)V" xml:id="oai:arXiv.org:cs0101001.S3.p7.m1"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S3.p7.m1.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok><XMTok role="UNKNOWN" font="italic">V</XMTok></XMath></Math> by noting
<!-- %**** cs0101001/ad.tex Line 550 **** -->that if column <Math mode="inline" tex="j" xml:id="oai:arXiv.org:cs0101001.S3.p7.m2"><XMath><XMTok role="UNKNOWN" font="italic">j</XMTok></XMath></Math> is in group <Math mode="inline" tex="k" xml:id="oai:arXiv.org:cs0101001.S3.p7.m3"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>, then</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S3.Ex8">
        <Math mode="display" tex="\langle e_{i},\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)Ve_{k}\rangle=v_{{i,j}}\partial _{{i,j}}\mbox{$f_{{\scriptscriptstyle E}}$}(x)." xml:id="oai\@colon arXiv.org\@colon cs0101001.S3.Ex8.m1">
          <XMath>
            <XMTok name="langle" role="OPEN">〈</XMTok>
            <XMTok role="UNKNOWN" font="italic">e</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">i</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="PUNCT">,</XMTok>
            <XMText>
              <text>
                <Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S3.Ex8.m1.m1">
                  <XMath>
                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">E</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="2">
              <XMArg rule="Superscript">
                <XMTok name="prime" role="SUPOP">′</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="UNKNOWN" font="italic">V</XMTok>
            <XMTok role="UNKNOWN" font="italic">e</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">k</XMTok>
              </XMArg>
            </XMApp>
            <XMTok name="rangle" role="CLOSE">〉</XMTok>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMTok role="UNKNOWN" font="italic">v</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok role="UNKNOWN" font="italic">j</XMTok>
              </XMArg>
            </XMApp>
            <XMTok meaning="partial-differential" name="partial" role="OPERATOR">∂</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok role="UNKNOWN" font="italic">j</XMTok>
              </XMArg>
            </XMApp>
            <XMText>
              <text>
                <Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S3.Ex8.m1.m2">
                  <XMath>
                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">E</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="PERIOD">.</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>Thus <Math mode="inline" tex="\partial _{{i,j}}\mbox{$f_{{\scriptscriptstyle E}}$}(x)" xml:id="oai:arXiv.org:cs0101001.S3.p7.m4"><XMath><XMTok meaning="partial-differential" name="partial" role="OPERATOR">∂</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMArg></XMApp><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S3.p7.m4.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math> can be recovered directly
from the compressed Jacobian matrix.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p8">
      <p>We note that for many sparsity patterns, the number
of groups <Math mode="inline" tex="p" xml:id="oai:arXiv.org:cs0101001.S3.p8.m1"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok></XMath></Math> needed to determine <Math mode="inline" tex="A\in\mbox{${\mathbb{R}}$}^{{m\times n}}" xml:id="oai:arXiv.org:cs0101001.S3.p8.m2"><XMath><XMTok role="UNKNOWN" font="italic">A</XMTok><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S3.p8.m2.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok meaning="times" role="MULOP">×</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMArg></XMApp></XMath></Math>
with a partitioning of the columns is small and independent of <Math mode="inline" tex="n" xml:id="oai:arXiv.org:cs0101001.S3.p8.m3"><XMath><XMTok role="UNKNOWN" font="italic">n</XMTok></XMath></Math>.
In all cases there is a lower bound of <Math mode="inline" tex="p\ge\mbox{$\rho _{{\scriptscriptstyle M}}$}" xml:id="oai:arXiv.org:cs0101001.S3.p8.m4"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok><XMTok meaning="greater-than-or-equals" name="ge" role="RELOP">≥</XMTok><XMText><text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S3.p8.m4.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text></XMText></XMath></Math>.
We also know <cite>[<bibref bibrefs="tfc83" separator="," show="Number" yyseparator=","/>]</cite> that if a matrix <Math mode="inline" tex="A" xml:id="oai:arXiv.org:cs0101001.S3.p8.m5"><XMath><XMTok role="UNKNOWN" font="italic">A</XMTok></XMath></Math>
can be permuted to a matrix
with bandwidth <Math mode="inline" tex="\textit{band}(A)" xml:id="oai:arXiv.org:cs0101001.S3.p8.m6"><XMath><XMText>band</XMText><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">A</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math>, then <Math mode="inline" tex="p\le\textit{band}(A)" xml:id="oai:arXiv.org:cs0101001.S3.p8.m7"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok><XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok><XMText>band</XMText><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">A</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math>.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p9">
      <p>The sparse AD approach uses a sparse data representation,
usually in conjunction with dynamic memory allocation, to carry out
all intermediate derivative computations.
At present, the
SparsLinC library in ADIFOR <cite>[<bibref bibrefs="adifor2-revc" separator="," show="Number" yyseparator=","/>]</cite>
is the only automatic differentiation tool with this capability.
The main advantage of the sparse AD approach over
the compressed AD approach
is that no knowledge of the sparsity pattern is required.
<!-- %**** cs0101001/ad.tex Line 575 **** -->On the other hand, the sparse AD approach is almost always
slower, and can be significantly slower on vector machines.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p10">
      <p>In an optimization setting, a hybrid approach <cite>[<bibref bibrefs="ab95" separator="," show="Number" yyseparator=","/>]</cite> is the best
approach. With this strategy, the sparse AD approach is used to
obtain the sparsity pattern of the Jacobian matrix
of the extended function at the starting point.
See Section <ref labelref="LABEL:sec:hessians"/> for additional information on
techniques for computing the sparsity
pattern of the extended function.
Once the sparsity pattern is determined,
the compressed AD approach is used on all other iterations.
The hybrid approach is currently the best approach to compute
gradients of partially separable functions, and is used in all solvers
installed on the NEOS Server.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p11">
      <p>We conclude this section with some recent results on
using the sparse AD approach to compute the gradients of
partially separable functions drawn from the <text><text font="sansserif" size="footnote">MINPACK-2</text></text> <cite>[<bibref bibrefs="bma91a" separator="," show="Number" yyseparator=","/>]</cite>
collection of test problems.
We selected ten problems; the first five problems are
finite element formulations of variational problems, while the last
five problems are systems of nonlinear equations
derived from collocation or difference formulations of systems
of differential equations.
<!-- %**** cs0101001/ad.tex Line 600 **** --></p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p12">
      <p>Table <ref labelref="LABEL:grads:data"/> provides the value of <text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S3.p12.m1.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text> for the
ten problems in our performance results.
For each of the problems we
used three values of <Math mode="inline" tex="n" xml:id="oai:arXiv.org:cs0101001.S3.p12.m2"><XMath><XMTok role="UNKNOWN" font="italic">n</XMTok></XMath></Math>,
usually <Math mode="inline" tex="n\in\{ 1/4,1,4\}\cdot 10^{4}" xml:id="oai:arXiv.org:cs0101001.S3.p12.m3"><XMath><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="OPEN" font="italic">{</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok meaning="divide" role="MULOP" style="inline">/</XMTok><XMTok meaning="4" role="NUMBER">4</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="4" role="NUMBER">4</XMTok><XMTok role="CLOSE" font="italic">}</XMTok><XMTok name="cdot" role="MULOP">⋅</XMTok><XMTok meaning="10" role="NUMBER">10</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok meaning="4" role="NUMBER">4</XMTok></XMArg></XMApp></XMath></Math>,
<!-- %2500 $, $10,000$, and $40,000$, -->to observe
the trend in performance as the number of variables increases.
The results were essentially independent of the number of
variables, so our results are indicative of the performance
that can be expected in large-scale problems.</p>
    </para>
    <table placement="ht" refnum="3.1" xml:id="oai:arXiv.org:cs0101001.S3.T1" labels="LABEL:grads:data">
      <caption class="centering">Data for <text><text font="sansserif" size="footnote">MINPACK-2</text></text> test problems</caption>
      <tabular class="centering">
        <thead>
          <tr>
            <td border="r"/>
            <td align="center" thead="true">
              <text font="smallcaps">pjb</text>
            </td>
            <td align="center" thead="true">
              <text font="smallcaps">msa</text>
            </td>
            <td align="center" thead="true">
              <text font="smallcaps">odc</text>
            </td>
            <td align="center" thead="true">
              <text font="smallcaps">ssc</text>
            </td>
            <td align="center" thead="true">
              <text font="smallcaps">gl2</text>
            </td>
            <td align="center" thead="true">
              <text font="smallcaps">fic</text>
            </td>
            <td align="center" thead="true">
              <text font="smallcaps">sfd</text>
            </td>
            <td align="center" thead="true">
              <text font="smallcaps">ier</text>
            </td>
            <td align="center" thead="true">
              <text font="smallcaps">sfi</text>
            </td>
            <td align="center" thead="true">
              <text font="smallcaps">fdc</text>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="center" border="r t" thead="true">
              <text>
                <Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S3.T1.m1">
                  <XMath>
                    <XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="11">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">M</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </td>
            <td align="center" border="t">5</td>
            <td align="center" border="t">4</td>
            <td align="center" border="t">4</td>
            <td align="center" border="t">4</td>
            <td align="center" border="t">5</td>
            <td align="center" border="t">9</td>
            <td align="center" border="t">14</td>
            <td align="center" border="t">17</td>
            <td align="center" border="t">5</td>
            <td align="center" border="t">13</td>
          </tr>
        </tbody>
      </tabular>
      <!-- %**** cs0101001/ad.tex Line 625 **** -->
    </table>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p13">
      <p>We want to show that the bounds <text>(<ref labelref="LABEL:psf:bound"/>)</text>
for <text><Math mode="inline" tex="\Omega _{{\scriptscriptstyle T,G}}" xml:id="oai:arXiv.org:cs0101001.S3.p13.m1.m1"><XMath><XMTok name="Omega" role="UNKNOWN">Ω</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">T</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">G</XMTok></XMArg></XMApp></XMath></Math></text> holds for these problems.
For these results we used the sparse approach to compute
the Jacobian matrix <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)" xml:id="oai:arXiv.org:cs0101001.S3.p13.m2"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S3.p13.m2.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math> of the extended function,
and then computed the gradient of <Math mode="inline" tex="f" xml:id="oai:arXiv.org:cs0101001.S3.p13.m3"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math> with <text>(<ref labelref="LABEL:grads:psf"/>)</text>.
For each problem we computed
the ratio <Math mode="inline" tex="\kappa _{1}" xml:id="oai:arXiv.org:cs0101001.S3.p13.m4"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="1" role="NUMBER">1</XMTok></XMArg></XMApp></XMath></Math>, where</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S3.Ex9">
        <Math mode="display" tex="T\left\{\nabla f(x)\right\}=\kappa _{1}\,\mbox{$\rho _{{\scriptscriptstyle M}}$}\max T\{ f(x)\}." xml:id="oai\@colon arXiv.org\@colon cs0101001.S3.Ex9.m1">
          <XMath>
            <XMTok role="UNKNOWN" font="italic">T</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok name="nabla" role="OPERATOR">∇</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMArg>
            </XMApp>
            <XMHint name="thinspace"/>
            <XMText>
              <text>
                <Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S3.Ex9.m1.m1">
                  <XMath>
                    <XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">M</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok meaning="maximum" role="LIMITOP" scriptpos="mid">max</XMTok>
            <XMTok role="UNKNOWN" font="italic">T</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok role="PERIOD">.</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>Table <ref labelref="LABEL:grads:table"/> presents the quartiles for <Math mode="inline" tex="\kappa _{1}" xml:id="oai:arXiv.org:cs0101001.S3.p13.m5"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="1" role="NUMBER">1</XMTok></XMArg></XMApp></XMath></Math>
obtained on a Pentium 3 (500 MHz clock, 128 MB of memory)
with the Linux operating system.</p>
    </para>
    <table placement="ht" refnum="3.2" xml:id="oai:arXiv.org:cs0101001.S3.T2" labels="LABEL:grads:table">
      <caption class="centering">Quartiles for <Math mode="inline" tex="\kappa _{1}" xml:id="oai:arXiv.org:cs0101001.S3.T2.m1"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok meaning="1" role="NUMBER">1</XMTok></XMArg></XMApp></XMath></Math> on the <text><text font="sansserif" size="footnote">MINPACK-2</text></text> problems</caption>
      <tabular class="centering">
        <thead>
          <tr>
            <td align="center" thead="true">
              <Math mode="inline" tex="\min" xml:id="oai:arXiv.org:cs0101001.S3.T2.m2">
                <XMath>
                  <XMTok meaning="minimum" role="LIMITOP" scriptpos="post">min</XMTok>
                </XMath>
              </Math>
            </td>
            <td align="center" thead="true">
              <Math mode="inline" tex="q_{1}" xml:id="oai:arXiv.org:cs0101001.S3.T2.m3">
                <XMath>
                  <XMTok role="UNKNOWN" font="italic">q</XMTok>
                  <XMApp role="POSTSUBSCRIPT" scriptpos="10">
                    <XMArg rule="Subscript">
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMArg>
                  </XMApp>
                </XMath>
              </Math>
            </td>
            <td align="center" thead="true">
              <Math mode="inline" tex="q_{2}" xml:id="oai:arXiv.org:cs0101001.S3.T2.m4">
                <XMath>
                  <XMTok role="UNKNOWN" font="italic">q</XMTok>
                  <XMApp role="POSTSUBSCRIPT" scriptpos="10">
                    <XMArg rule="Subscript">
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                    </XMArg>
                  </XMApp>
                </XMath>
              </Math>
            </td>
            <td align="center" thead="true">
              <Math mode="inline" tex="q_{3}" xml:id="oai:arXiv.org:cs0101001.S3.T2.m5">
                <XMath>
                  <XMTok role="UNKNOWN" font="italic">q</XMTok>
                  <XMApp role="POSTSUBSCRIPT" scriptpos="10">
                    <XMArg rule="Subscript">
                      <XMTok meaning="3" role="NUMBER">3</XMTok>
                    </XMArg>
                  </XMApp>
                </XMath>
              </Math>
            </td>
            <td align="center" thead="true">
              <Math mode="inline" tex="\max" xml:id="oai:arXiv.org:cs0101001.S3.T2.m6">
                <XMath>
                  <XMTok meaning="maximum" role="LIMITOP" scriptpos="post">max</XMTok>
                </XMath>
              </Math>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="center" border="b t">1.3</td>
            <td align="center" border="b t">2.8</td>
            <td align="center" border="b t">4.5</td>
            <td align="center" border="b t">5.3</td>
            <td align="center" border="b t">7.8</td>
          </tr>
        </tbody>
      </tabular>
    </table>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p14">
      <p>The results in Table <ref labelref="LABEL:grads:table"/> show that the
bound <text>(<ref labelref="LABEL:psf:bound"/>)</text> for <text><Math mode="inline" tex="\Omega _{{\scriptscriptstyle T,G}}" xml:id="oai:arXiv.org:cs0101001.S3.p14.m1.m1"><XMath><XMTok name="Omega" role="UNKNOWN">Ω</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">T</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">G</XMTok></XMArg></XMApp></XMath></Math></text> holds for
the <text><text font="sansserif" size="footnote">MINPACK-2</text></text> problems, with <Math mode="inline" tex="\kappa _{1}" xml:id="oai:arXiv.org:cs0101001.S3.p14.m2"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="1" role="NUMBER">1</XMTok></XMArg></XMApp></XMath></Math> small.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S3.p15">
      <p>These results are consistent with the results in
<cite>[<bibref bibrefs="bouaricha94" separator="," show="Number" yyseparator=","/>]</cite>, where it was shown that
<Math mode="inline" tex="\kappa _{1}\in[3,15]" xml:id="oai:arXiv.org:cs0101001.S3.p15.m1"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="1" role="NUMBER">1</XMTok></XMArg></XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="OPEN">[</XMTok><XMTok meaning="3" role="NUMBER">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="15" role="NUMBER">15</XMTok><XMTok role="CLOSE">]</XMTok></XMath></Math> on a SPARC-10 for another
set of test problems drawn from the <text><text font="sansserif" size="footnote">MINPACK-2</text></text> collection.
Note that in <cite>[<bibref bibrefs="bouaricha94" separator="," show="Number" yyseparator=","/>]</cite> the ratio <Math mode="inline" tex="\kappa _{1}" xml:id="oai:arXiv.org:cs0101001.S3.p15.m2"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="1" role="NUMBER">1</XMTok></XMArg></XMApp></XMath></Math> was
computed with <text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S3.p15.m3.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text> replaced by the number of columns <Math mode="inline" tex="p" xml:id="oai:arXiv.org:cs0101001.S3.p15.m4"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok></XMath></Math>
in the matrix <Math mode="inline" tex="V" xml:id="oai:arXiv.org:cs0101001.S3.p15.m5"><XMath><XMTok role="UNKNOWN" font="italic">V</XMTok></XMath></Math>. Since <Math mode="inline" tex="p\ge\mbox{$\rho _{{\scriptscriptstyle M}}$}" xml:id="oai:arXiv.org:cs0101001.S3.p15.m6"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok><XMTok meaning="greater-than-or-equals" name="ge" role="RELOP">≥</XMTok><XMText><text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S3.p15.m6.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text></XMText></XMath></Math>, the ratios in
Table <ref labelref="LABEL:grads:table"/> would decrease if we replaced <text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S3.p15.m7.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text> by <Math mode="inline" tex="p" xml:id="oai:arXiv.org:cs0101001.S3.p15.m8"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok></XMath></Math>.
The advantage of using <text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S3.p15.m9.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text> is that
the ratio <Math mode="inline" tex="\kappa _{1}" xml:id="oai:arXiv.org:cs0101001.S3.p15.m10"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="1" role="NUMBER">1</XMTok></XMArg></XMApp></XMath></Math> is then dependent only on the structure
of the function.</p>
    </para>
  </section>
  <section refnum="4" xml:id="oai:arXiv.org:cs0101001.S4" labels="LABEL:sec:hessians LABEL:hessians:adhess">
    <title>Computing Hessian Matrices</title>
    <!-- %**** cs0101001/ad.tex Line 675 **** -->
    <para xml:id="oai:arXiv.org:cs0101001.S4.p1">
      <p>We have already shown how automatic differentiation tools
can be used to compute the gradient of a partially separable function.
We now discuss the tools that are needed
to compute the Hessian of a partially separable so that
the requirements <text>(<ref labelref="LABEL:psf:ctime"/>)</text> on computing time and
<text>(<ref labelref="LABEL:psf:cmem"/>)</text> on memory are satisfied.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S4.p2">
      <p>The techniques that we propose require the
sparsity pattern of the Hessian matrix and that
the Hessian-vector products <Math mode="inline" tex="\nabla^{2}f(x)v" xml:id="oai:arXiv.org:cs0101001.S4.p2.m1"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok><XMTok role="UNKNOWN" font="italic">v</XMTok></XMath></Math> be available.
In our numerical results we approximate
the Hessian-vector product with a difference of gradient
values, but in future work we expect to compute Hessian-vector
products with ADIFOR.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S4.p3">
      <p>We now show how to compute the sparsity pattern
of the Hessian matrix from the sparsity pattern of <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)" xml:id="oai:arXiv.org:cs0101001.S4.p3.m1"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m1.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math>.
We define the sparsity pattern of a matrix-valued mapping
<Math mode="inline" tex="A:\mbox{${\mathbb{R}}$}^{n}\mapsto\mbox{${\mathbb{R}}$}^{{n\times n}}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m2"><XMath><XMTok role="UNKNOWN" font="italic">A</XMTok><XMTok name="colon" role="METARELOP">:</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m2.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">n</XMTok></XMArg></XMApp><XMTok meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m2.m2"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok meaning="times" role="MULOP">×</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMArg></XMApp></XMath></Math>
in a neighborhood <Math mode="inline" tex="N(x_{0})" xml:id="oai:arXiv.org:cs0101001.S4.p3.m3"><XMath><XMTok role="UNKNOWN" font="italic">N</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok></XMath></Math> of a point <Math mode="inline" tex="x_{0}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m4"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp></XMath></Math> by</p>
      <equation refnum="7" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.E7" labels="LABEL:hessians:pattern">
        <Math mode="display" tex="\mbox{$\cal S$}\left\{ A(x_{0})\right\}\equiv\biggl\{(i,j):a_{{i,j}}(x)\not\equiv 0,\  x\in N(x_{0})\biggr\}." xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.E7.m1">
          <XMath>
            <!-- %**** cs0101001/ad.tex Line 700 **** -->
            <XMText>
              <text>
                <Math mode="inline" tex="\cal S" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.E7.m1.m1">
                  <XMath>
                    <XMTok role="UNKNOWN" font="caligraphic">S</XMTok>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok role="UNKNOWN" font="italic">A</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok meaning="identical-to" name="equiv" role="RELOP">≡</XMTok>
            <XMTok role="OPEN" size="bigg" font="italic">{</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">i</XMTok>
            <XMTok role="PUNCT">,</XMTok>
            <XMTok role="UNKNOWN" font="italic">j</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok name="colon" role="METARELOP">:</XMTok>
            <XMTok role="UNKNOWN" font="italic">a</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok role="UNKNOWN" font="italic">j</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok meaning="not-identical-to" name="not-equiv" role="RELOP">≢</XMTok>
            <XMTok meaning="0" role="NUMBER">0</XMTok>
            <XMTok role="PUNCT">,</XMTok>
            <XMHint name="medspace"/>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
            <XMTok role="UNKNOWN" font="italic">N</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" size="bigg" font="italic">}</XMTok>
            <XMTok role="PERIOD">.</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>We are interested in the sparsity
pattern of the extended Jacobian and the Hessian matrix of a partially
separable function <Math mode="inline" tex="f:\mbox{${\mathbb{R}}$}^{n}\mapsto\mbox{${\mathbb{R}}$}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m5"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok name="colon" role="METARELOP">:</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m5.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">n</XMTok></XMArg></XMApp><XMTok meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m5.m2"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText></XMath></Math> in
a region <text><Math mode="inline" tex="\cal D" xml:id="oai:arXiv.org:cs0101001.S4.p3.m6.m1"><XMath><XMTok role="UNKNOWN" font="caligraphic">D</XMTok></XMath></Math></text> of the form</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.Ex10">
        <Math mode="display" tex="\mbox{$\cal D$}=\left\{ x\in\mbox{${\mathbb{R}}$}^{n}:x_{l}\le x\le x_{u}\right\}." xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.Ex10.m1">
          <XMath>
            <XMText>
              <text>
                <Math mode="inline" tex="\cal D" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.Ex10.m1.m1">
                  <XMath>
                    <XMTok role="UNKNOWN" font="caligraphic">D</XMTok>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
            <XMText>
              <text>
                <Math mode="inline" tex="{\mathbb{R}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.Ex10.m1.m2">
                  <XMath>
                    <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="3">
              <XMArg rule="Superscript">
                <XMTok role="UNKNOWN" font="italic">n</XMTok>
              </XMArg>
            </XMApp>
            <XMTok name="colon" role="METARELOP">:</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">l</XMTok>
              </XMArg>
            </XMApp>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok meaning="less-than-or-equals" name="le" role="RELOP">≤</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">u</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok role="PERIOD">.</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>Given  <Math mode="inline" tex="x\in\mbox{$\cal D$}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m7"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMText><text><Math mode="inline" tex="\cal D" xml:id="oai:arXiv.org:cs0101001.S4.p3.m7.m1"><XMath><XMTok role="UNKNOWN" font="caligraphic">D</XMTok></XMath></Math></text></XMText></XMath></Math>, we evaluate the sparsity pattern
<Math mode="inline" tex="\mbox{$\cal S$}\left\{\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)\right\}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m8"><XMath><XMText><text><Math mode="inline" tex="\cal S" xml:id="oai:arXiv.org:cs0101001.S4.p3.m8.m1"><XMath><XMTok role="UNKNOWN" font="caligraphic">S</XMTok></XMath></Math></text></XMText><XMTok role="OPEN" font="italic">{</XMTok><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m8.m2"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="5"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="3"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok><XMTok role="CLOSE" font="italic">}</XMTok></XMath></Math>
by computing <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(\bar{x}_{0})" xml:id="oai:arXiv.org:cs0101001.S4.p3.m9"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m9.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMApp><XMTok name="bar" role="OVERACCENT">¯</XMTok><XMArg><XMTok role="UNKNOWN" font="italic">x</XMTok></XMArg></XMApp><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok></XMath></Math>, where
<Math mode="inline" tex="\bar{x}_{0}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m10"><XMath><XMApp><XMTok name="bar" role="OVERACCENT">¯</XMTok><XMArg><XMTok role="UNKNOWN" font="italic">x</XMTok></XMArg></XMApp><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp></XMath></Math> is a random, small
perturbation of <Math mode="inline" tex="x_{0}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m11"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp></XMath></Math>, for example,</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.Ex11">
        <Math mode="display" tex="\bar{x}_{0}=(1+\varepsilon)x_{0}+\varepsilon,\qquad|\varepsilon|\in[10^{{-6}},10^{{-4}}]." xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.Ex11.m1">
          <XMath>
            <XMApp>
              <XMTok name="bar" role="OVERACCENT">¯</XMTok>
              <XMArg>
                <XMTok role="UNKNOWN" font="italic">x</XMTok>
              </XMArg>
            </XMApp>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMArg>
            </XMApp>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok meaning="1" role="NUMBER">1</XMTok>
            <XMTok meaning="plus" role="ADDOP">+</XMTok>
            <XMTok name="varepsilon" role="UNKNOWN" font="italic">ε</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMArg>
            </XMApp>
            <XMTok meaning="plus" role="ADDOP">+</XMTok>
            <XMTok name="varepsilon" role="UNKNOWN" font="italic">ε</XMTok>
            <XMTok role="PUNCT">,</XMTok>
            <XMHint name="qquad"/>
            <XMTok role="VERTBAR">|</XMTok>
            <XMTok name="varepsilon" role="UNKNOWN" font="italic">ε</XMTok>
            <XMTok role="VERTBAR">|</XMTok>
            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
            <XMTok role="OPEN">[</XMTok>
            <XMTok meaning="10" role="NUMBER">10</XMTok>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="2">
              <XMArg rule="Superscript">
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMTok meaning="6" role="NUMBER">6</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="PUNCT">,</XMTok>
            <XMTok meaning="10" role="NUMBER">10</XMTok>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="2">
              <XMArg rule="Superscript">
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMTok meaning="4" role="NUMBER">4</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="CLOSE">]</XMTok>
            <XMTok role="PERIOD">.</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>Then we can reliably let
<Math mode="inline" tex="\mbox{$\cal S$}\left\{\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)\right\}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m12"><XMath><XMText><text><Math mode="inline" tex="\cal S" xml:id="oai:arXiv.org:cs0101001.S4.p3.m12.m1"><XMath><XMTok role="UNKNOWN" font="caligraphic">S</XMTok></XMath></Math></text></XMText><XMTok role="OPEN" font="italic">{</XMTok><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m12.m2"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="5"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="3"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok><XMTok role="CLOSE" font="italic">}</XMTok></XMath></Math> be
the set of <Math mode="inline" tex="(i,j)" xml:id="oai:arXiv.org:cs0101001.S4.p3.m13"><XMath><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math> such that <Math mode="inline" tex="\partial _{{i,j}}\mbox{$f_{{\scriptscriptstyle E}}$}(\bar{x}_{0})\neq 0" xml:id="oai:arXiv.org:cs0101001.S4.p3.m14"><XMath><XMTok meaning="partial-differential" name="partial" role="OPERATOR">∂</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMArg></XMApp><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m14.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMTok role="OPEN">(</XMTok><XMApp><XMTok name="bar" role="OVERACCENT">¯</XMTok><XMArg><XMTok role="UNKNOWN" font="italic">x</XMTok></XMArg></XMApp><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok><XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMath></Math>.
We should not obtain the sparsity pattern of the Jacobian matrix
by evaluating <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m15"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m15.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp></XMath></Math> at the starting point <Math mode="inline" tex="x_{0}" xml:id="oai:arXiv.org:cs0101001.S4.p3.m16"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp></XMath></Math>
of the optimization process because this point
<!-- %**** cs0101001/ad.tex Line 725 **** -->is invariably special, and thus the sparsity pattern of
the Jacobian matrix is unlikely to be representative.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S4.p4">
      <p>The technique that we have outlined for determining the sparsity
pattern is used by the solvers in the NEOS Server and has proved
to be quite reliable. The sign of <Math mode="inline" tex="\varepsilon" xml:id="oai:arXiv.org:cs0101001.S4.p4.m1"><XMath><XMTok name="varepsilon" role="UNKNOWN" font="italic">ε</XMTok></XMath></Math> must be
chosen so that <Math mode="inline" tex="\bar{x}_{0}\in\mbox{$\cal D$}" xml:id="oai:arXiv.org:cs0101001.S4.p4.m2"><XMath><XMApp><XMTok name="bar" role="OVERACCENT">¯</XMTok><XMArg><XMTok role="UNKNOWN" font="italic">x</XMTok></XMArg></XMApp><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMText><text><Math mode="inline" tex="\cal D" xml:id="oai:arXiv.org:cs0101001.S4.p4.m2.m1"><XMath><XMTok role="UNKNOWN" font="caligraphic">D</XMTok></XMath></Math></text></XMText></XMath></Math>, and special care must be taken
to handle the case when <Math mode="inline" tex="x_{l}" xml:id="oai:arXiv.org:cs0101001.S4.p4.m3"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">l</XMTok></XMArg></XMApp></XMath></Math> and <Math mode="inline" tex="x_{u}" xml:id="oai:arXiv.org:cs0101001.S4.p4.m4"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">u</XMTok></XMArg></XMApp></XMath></Math> agree in some component.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S4.p5">
      <p>Given the sparsity pattern of the Jacobian matrix of the
extended function, we determine the sparsity pattern for the
Hessian  <Math mode="inline" tex="\nabla^{2}f(x)" xml:id="oai:arXiv.org:cs0101001.S4.p5.m1"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math> of the partially separable function <Math mode="inline" tex="f" xml:id="oai:arXiv.org:cs0101001.S4.p5.m2"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math> via</p>
      <equation refnum="8" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.E8" labels="LABEL:hessians:sparse">
        <Math mode="display" tex="\mbox{$\cal S$}\left\{\nabla^{2}f(x)\right\}\subset\mbox{$\cal S$}\left\{\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)^{T}\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x)\right\}." xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.E8.m1">
          <XMath>
            <XMText>
              <text>
                <Math mode="inline" tex="\cal S" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.E8.m1.m1">
                  <XMath>
                    <XMTok role="UNKNOWN" font="caligraphic">S</XMTok>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok name="nabla" role="OPERATOR">∇</XMTok>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="3">
              <XMArg rule="Superscript">
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok meaning="subset-of" name="subset" role="RELOP">⊂</XMTok>
            <XMText>
              <text>
                <Math mode="inline" tex="\cal S" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.E8.m1.m2">
                  <XMath>
                    <XMTok role="UNKNOWN" font="caligraphic">S</XMTok>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMText>
              <text>
                <Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.E8.m1.m3">
                  <XMath>
                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="5">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">E</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="3">
              <XMArg rule="Superscript">
                <XMTok name="prime" role="SUPOP">′</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="3">
              <XMArg rule="Superscript">
                <XMTok role="UNKNOWN" font="italic">T</XMTok>
              </XMArg>
            </XMApp>
            <XMText>
              <text>
                <Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.E8.m1.m4">
                  <XMath>
                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="5">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">E</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="3">
              <XMArg rule="Superscript">
                <XMTok name="prime" role="SUPOP">′</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok role="PERIOD">.</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>Note that <text>(<ref labelref="LABEL:hessians:sparse"/>)</text> is valid only in terms of
the definition <text>(<ref labelref="LABEL:hessians:pattern"/>)</text> for a
sparsity pattern. For example,
if <Math mode="inline" tex="f:\mbox{${\mathbb{R}}$}^{2}\mapsto\mbox{${\mathbb{R}}$}" xml:id="oai:arXiv.org:cs0101001.S4.p5.m3"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok name="colon" role="METARELOP">:</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S4.p5.m3.m1"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok><XMText><text><Math mode="inline" tex="{\mathbb{R}}" xml:id="oai:arXiv.org:cs0101001.S4.p5.m3.m2"><XMath><XMTok role="UNKNOWN" font="blackboard">R</XMTok></XMath></Math></text></XMText></XMath></Math> is defined by</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.Ex12">
        <Math mode="display" tex="f(x)=\phi(\xi _{1}\xi _{2})" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.Ex12.m1">
          <XMath>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMTok name="phi" role="UNKNOWN" font="italic">ϕ</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok name="xi" role="UNKNOWN" font="italic">ξ</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMArg>
            </XMApp>
            <XMTok name="xi" role="UNKNOWN" font="italic">ξ</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="CLOSE">)</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>for a function <Math mode="inline" tex="\phi" xml:id="oai:arXiv.org:cs0101001.S4.p5.m4"><XMath><XMTok name="phi" role="UNKNOWN" font="italic">ϕ</XMTok></XMath></Math> such that <Math mode="inline" tex="\phi^{{\prime}}(0)\neq 0" xml:id="oai:arXiv.org:cs0101001.S4.p5.m5"><XMath><XMTok name="phi" role="UNKNOWN" font="italic">ϕ</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok><XMTok role="CLOSE">)</XMTok><XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMath></Math>, then
<!-- %**** cs0101001/ad.tex Line 750 **** --><Math mode="inline" tex="\partial _{{1,2}}f(0)\neq 0" xml:id="oai:arXiv.org:cs0101001.S4.p5.m6"><XMath><XMTok meaning="partial-differential" name="partial" role="OPERATOR">∂</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok><XMTok role="CLOSE">)</XMTok><XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMath></Math>, but
<Math mode="inline" tex="\partial _{1}f(0)=\partial _{2}f(0)=0" xml:id="oai:arXiv.org:cs0101001.S4.p5.m7"><XMath><XMTok meaning="partial-differential" name="partial" role="OPERATOR">∂</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="1" role="NUMBER">1</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok><XMTok role="CLOSE">)</XMTok><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok meaning="partial-differential" name="partial" role="OPERATOR">∂</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok><XMTok role="CLOSE">)</XMTok><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMath></Math>.
However, <text>(<ref labelref="LABEL:hessians:sparse"/>)</text> holds because
<Math mode="inline" tex="\partial _{2}f(x)\not\equiv 0" xml:id="oai:arXiv.org:cs0101001.S4.p5.m8"><XMath><XMTok meaning="partial-differential" name="partial" role="OPERATOR">∂</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok><XMTok meaning="not-identical-to" name="not-equiv" role="RELOP">≢</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMath></Math> and
<Math mode="inline" tex="\partial _{1}f(x)\not\equiv 0" xml:id="oai:arXiv.org:cs0101001.S4.p5.m9"><XMath><XMTok meaning="partial-differential" name="partial" role="OPERATOR">∂</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="1" role="NUMBER">1</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok><XMTok meaning="not-identical-to" name="not-equiv" role="RELOP">≢</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMath></Math> in a neighborhood
of the origin.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S4.p6">
      <p>In most cases equality holds in <text>(<ref labelref="LABEL:hessians:sparse"/>)</text>.
This happens, in particular,
if <Math mode="inline" tex="f" xml:id="oai:arXiv.org:cs0101001.S4.p6.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math> does not depend linearly on the
variables, and</p>
      <equation refnum="9" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.E9" labels="LABEL:hessians:nocancel">
        <Math mode="display" tex="\bigcup _{{k=1}}^{{m}}\mbox{$\cal S$}\left\{\nabla^{2}f_{k}(x)\right\}\subset\mbox{$\cal S$}\left\{\nabla^{2}f(x)\right\}." xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.E9.m1">
          <XMath>
            <XMTok meaning="union" name="bigcup" role="SUMOP" scriptpos="mid">⋃</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">k</XMTok>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMArg>
            </XMApp>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="2">
              <XMArg rule="Superscript">
                <XMTok role="UNKNOWN" font="italic">m</XMTok>
              </XMArg>
            </XMApp>
            <XMText>
              <text>
                <Math mode="inline" tex="\cal S" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.E9.m1.m1">
                  <XMath>
                    <XMTok role="UNKNOWN" font="caligraphic">S</XMTok>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok name="nabla" role="OPERATOR">∇</XMTok>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="3">
              <XMArg rule="Superscript">
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="3">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">k</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok meaning="subset-of" name="subset" role="RELOP">⊂</XMTok>
            <XMText>
              <text>
                <Math mode="inline" tex="\cal S" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.E9.m1.m2">
                  <XMath>
                    <XMTok role="UNKNOWN" font="caligraphic">S</XMTok>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok name="nabla" role="OPERATOR">∇</XMTok>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="3">
              <XMArg rule="Superscript">
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok role="PERIOD">.</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>If <Math mode="inline" tex="f" xml:id="oai:arXiv.org:cs0101001.S4.p6.m2"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math> depends linearly on some variables, say,</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.Ex13">
        <Math mode="display" tex="f(x)=\xi _{1}+\phi(\xi _{2},\ldots,\xi _{n})," xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.Ex13.m1">
          <XMath>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMTok name="xi" role="UNKNOWN" font="italic">ξ</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMArg>
            </XMApp>
            <XMTok meaning="plus" role="ADDOP">+</XMTok>
            <XMTok name="phi" role="UNKNOWN" font="italic">ϕ</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok name="xi" role="UNKNOWN" font="italic">ξ</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="PUNCT">,</XMTok>
            <XMTok name="ldots" role="ID">…</XMTok>
            <XMTok role="PUNCT">,</XMTok>
            <XMTok name="xi" role="UNKNOWN" font="italic">ξ</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok role="UNKNOWN" font="italic">n</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="PUNCT">,</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>then equality does not hold in <text>(<ref labelref="LABEL:hessians:sparse"/>)</text>.
Assumption <text>(<ref labelref="LABEL:hessians:nocancel"/>)</text> implies that there
is no cancellation in the computation of the
Hessian <Math mode="inline" tex="\nabla^{2}f(x)" xml:id="oai:arXiv.org:cs0101001.S4.p6.m3"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok></XMath></Math>. This assumption can fail in some
cases, for example, when <Math mode="inline" tex="f_{1}\equiv-f_{2}" xml:id="oai:arXiv.org:cs0101001.S4.p6.m4"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="1" role="NUMBER">1</XMTok></XMArg></XMApp><XMTok meaning="identical-to" name="equiv" role="RELOP">≡</XMTok><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp></XMath></Math>, but holds in most cases.
<!-- %**** cs0101001/ad.tex Line 775 **** --></p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S4.p7">
      <p>Since we are able to estimate the sparsity pattern of the
Hessian matrix via <text>(<ref labelref="LABEL:hessians:sparse"/>)</text>, we could use the
compressed AD approach described in Section <ref labelref="LABEL:sec:gradients"/>
to compute the Hessian matrix from a compressed Hessian
<Math mode="inline" tex="\nabla^{2}f(x)V" xml:id="oai:arXiv.org:cs0101001.S4.p7.m1"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE">)</XMTok><XMTok role="UNKNOWN" font="italic">V</XMTok></XMath></Math>.
However, these techniques ignore the symmetry of the Hessian
matrix and thus may require an unnecessarily large number of
columns <Math mode="inline" tex="p" xml:id="oai:arXiv.org:cs0101001.S4.p7.m2"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok></XMath></Math> in the matrix <Math mode="inline" tex="V" xml:id="oai:arXiv.org:cs0101001.S4.p7.m3"><XMath><XMTok role="UNKNOWN" font="italic">V</XMTok></XMath></Math>.
For example, an arrowhead matrix requires <Math mode="inline" tex="p=n" xml:id="oai:arXiv.org:cs0101001.S4.p7.m4"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMath></Math> if symmetry
is ignored, but <Math mode="inline" tex="p=2" xml:id="oai:arXiv.org:cs0101001.S4.p7.m5"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMath></Math> otherwise.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S4.p8">
      <p>Powell and Toint <cite>[<bibref bibrefs="mjdp79" separator="," show="Number" yyseparator=","/>]</cite> were the first to
show that symmetry can be used to reduce the number <Math mode="inline" tex="p" xml:id="oai:arXiv.org:cs0101001.S4.p8.m1"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok></XMath></Math> of
columns in the matrix <Math mode="inline" tex="V" xml:id="oai:arXiv.org:cs0101001.S4.p8.m2"><XMath><XMTok role="UNKNOWN" font="italic">V</XMTok></XMath></Math>. They proposed two methods
for determining a symmetric matrix <Math mode="inline" tex="A" xml:id="oai:arXiv.org:cs0101001.S4.p8.m3"><XMath><XMTok role="UNKNOWN" font="italic">A</XMTok></XMath></Math> from a compressed
matrix <Math mode="inline" tex="AV" xml:id="oai:arXiv.org:cs0101001.S4.p8.m4"><XMath><XMTok role="UNKNOWN" font="italic">A</XMTok><XMTok role="UNKNOWN" font="italic">V</XMTok></XMath></Math>.
In the direct method the unknowns in <Math mode="inline" tex="A" xml:id="oai:arXiv.org:cs0101001.S4.p8.m5"><XMath><XMTok role="UNKNOWN" font="italic">A</XMTok></XMath></Math> are determined directly
from the elements in the compressed matrix <Math mode="inline" tex="AV" xml:id="oai:arXiv.org:cs0101001.S4.p8.m6"><XMath><XMTok role="UNKNOWN" font="italic">A</XMTok><XMTok role="UNKNOWN" font="italic">V</XMTok></XMath></Math>. In this
method unknowns are determined independently of each other.
In the substitution method the unknowns are determined in a given
order, either directly or as a linear combination of elements
that have been previously determined.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S4.p9">
      <p>These definitions of direct and substitution methods
<!-- %**** cs0101001/ad.tex Line 800 **** -->are precise but do not readily yield algorithms for
determining symmetric matrices.
Coleman and Moré <cite>[<bibref bibrefs="tfc84b" separator="," show="Number" yyseparator=","/>]</cite> and Coleman and Cai <cite>[<bibref bibrefs="tfc86" separator="," show="Number" yyseparator=","/>]</cite>
extended <cite>[<bibref bibrefs="mjdp79" separator="," show="Number" yyseparator=","/>]</cite> by interpreting
the problem of determining symmetric matrices
in terms of special graph coloring
problems. This work led to new algorithms and a deeper
understanding of the estimation problem.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S4.p10">
      <p>Software for the symmetric graph coloring problem is
available <cite>[<bibref bibrefs="tfc85" separator="," show="Number" yyseparator=","/>]</cite> for both direct and substitution methods.
Numerical results in <cite>[<bibref bibrefs="tfc84b" separator="," show="Number" yyseparator=","/>]</cite> suggest that a direct
method yields a 20% improvement over methods
that disregard symmetry,
and that the substitution method yields about
a 30% reduction over the direct method.</p>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S4.p11">
      <p>We use Algorithm <ref labelref="LABEL:hessians:adhess"/>
to compute the Hessian matrix
from a user-supplied extended function <text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p11.m1.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text>.
This algorithm uses static memory allocation so that
it is first necessary to determine the number of nonzeros in
<Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x_{0})" xml:id="oai:arXiv.org:cs0101001.S4.p11.m2"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p11.m2.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok></XMath></Math> by
computing <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x_{0})" xml:id="oai:arXiv.org:cs0101001.S4.p11.m3"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p11.m3.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok></XMath></Math> by rows, but not storing the entries.
Once this is done, we allocate space for <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x_{0})" xml:id="oai:arXiv.org:cs0101001.S4.p11.m4"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p11.m4.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok></XMath></Math>
<!-- %**** cs0101001/ad.tex Line 825 **** -->and compute <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x_{0})" xml:id="oai:arXiv.org:cs0101001.S4.p11.m5"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p11.m5.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok></XMath></Math> and the sparsity pattern.
Another interesting aspect of
Algorithm <ref labelref="LABEL:hessians:adhess"/> is that we compute
the number of nonzeros in <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x_{0})^{T}\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x_{0})" xml:id="oai:arXiv.org:cs0101001.S4.p11.m6"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p11.m6.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">T</XMTok></XMArg></XMApp><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p11.m6.m2"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok></XMath></Math>
directly from the sparsity pattern of <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x_{0})" xml:id="oai:arXiv.org:cs0101001.S4.p11.m7"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.S4.p11.m7.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok></XMath></Math>.
In view of <text>(<ref labelref="LABEL:hessians:sparse"/>)</text>, we then have an accurate
idea of the amount of memory needed to store the Hessian matrix.
The final step is to compute the Hessian matrix from the
the compressed Hessian matrix
<Math mode="inline" tex="\nabla^{2}f(x_{0})V" xml:id="oai:arXiv.org:cs0101001.S4.p11.m8"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="2"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok><XMTok role="UNKNOWN" font="italic">V</XMTok></XMath></Math> by either a direct or a substitution method.</p>
    </para>
    <ERROR class="undefined">\Algorithm</ERROR>
    <para xml:id="oai:arXiv.org:cs0101001.S4.p12">
      <itemize>
        <item xml:id="oai:arXiv.org:cs0101001.I1.i1">
          <para xml:id="oai:arXiv.org:cs0101001.I1.i1.p1">
            <p>Evaluate <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}(x_{0})" xml:id="oai:arXiv.org:cs0101001.I1.i1.p1.m1"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.I1.i1.p1.m1.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="5"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="3"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok></XMath></Math> and obtain <Math mode="inline" tex="m=\mbox{size}\mbox{$f_{{\scriptscriptstyle E}}$}(x_{0})" xml:id="oai:arXiv.org:cs0101001.I1.i1.p1.m2"><XMath><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok meaning="equals" role="RELOP">=</XMTok><XMText><text>size</text><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.I1.i1.p1.m2.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="5"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="3"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok></XMath></Math>.</p>
          </para>
        </item>
        <item xml:id="oai:arXiv.org:cs0101001.I1.i2">
          <para xml:id="oai:arXiv.org:cs0101001.I1.i2.p1">
            <p>Compute  <Math mode="inline" tex="\mbox{nnz}\{\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x_{0})\}" xml:id="oai:arXiv.org:cs0101001.I1.i2.p1.m1"><XMath><XMText><text>nnz</text></XMText><XMTok role="OPEN" font="italic">{</XMTok><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.I1.i2.p1.m1.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="5"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="3"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="3"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok><XMTok role="CLOSE" font="italic">}</XMTok></XMath></Math>.</p>
          </para>
        </item>
        <item xml:id="oai:arXiv.org:cs0101001.I1.i3">
          <para xml:id="oai:arXiv.org:cs0101001.I1.i3.p1">
            <p>Allocate space for <Math mode="inline" tex="\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x_{0})" xml:id="oai:arXiv.org:cs0101001.I1.i3.p1.m1"><XMath><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.I1.i3.p1.m1.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="5"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="3"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="3"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok></XMath></Math>.</p>
          </para>
        </item>
        <item xml:id="oai:arXiv.org:cs0101001.I1.i4">
          <para xml:id="oai:arXiv.org:cs0101001.I1.i4.p1">
            <p>Compute the sparsity pattern <Math mode="inline" tex="\mbox{$\cal S$}\{\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x_{0})\}" xml:id="oai:arXiv.org:cs0101001.I1.i4.p1.m1"><XMath><XMText><text><Math mode="inline" tex="\cal S" xml:id="oai:arXiv.org:cs0101001.I1.i4.p1.m1.m1"><XMath><XMTok role="UNKNOWN" font="caligraphic">S</XMTok></XMath></Math></text></XMText><XMTok role="OPEN" font="italic">{</XMTok><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.I1.i4.p1.m1.m2"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="5"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="3"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="3"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok><XMTok role="CLOSE" font="italic">}</XMTok></XMath></Math>.</p>
          </para>
        </item>
        <item xml:id="oai:arXiv.org:cs0101001.I1.i5">
          <para xml:id="oai:arXiv.org:cs0101001.I1.i5.p1">
            <p>Compute <Math mode="inline" tex="\mbox{nnz}\{\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x_{0})^{T}\mbox{$f_{{\scriptscriptstyle E}}$}^{{\prime}}(x_{0})\}" xml:id="oai:arXiv.org:cs0101001.I1.i5.p1.m1"><XMath><XMText><text>nnz</text></XMText><XMTok role="OPEN" font="italic">{</XMTok><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.I1.i5.p1.m1.m1"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="5"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="3"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="3"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="3"><XMArg rule="Superscript"><XMTok role="UNKNOWN" font="italic">T</XMTok></XMArg></XMApp><XMText><text><Math mode="inline" tex="f_{{\scriptscriptstyle E}}" xml:id="oai:arXiv.org:cs0101001.I1.i5.p1.m1.m2"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="5"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">E</XMTok></XMArg></XMApp></XMath></Math></text></XMText><XMApp role="POSTSUPERSCRIPT" scriptpos="3"><XMArg rule="Superscript"><XMTok name="prime" role="SUPOP">′</XMTok></XMArg></XMApp><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="3"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok><XMTok role="CLOSE" font="italic">}</XMTok></XMath></Math>.</p>
          </para>
        </item>
        <item xml:id="oai:arXiv.org:cs0101001.I1.i6">
          <para xml:id="oai:arXiv.org:cs0101001.I1.i6.p1">
            <p>Allocate space for <Math mode="inline" tex="\nabla^{2}f(x_{0})" xml:id="oai:arXiv.org:cs0101001.I1.i6.p1.m1"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="3"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="3"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok></XMath></Math>
<!-- %**** cs0101001/ad.tex Line 850 **** --></p>
          </para>
        </item>
        <item xml:id="oai:arXiv.org:cs0101001.I1.i7">
          <para xml:id="oai:arXiv.org:cs0101001.I1.i7.p1">
            <p>Compute <Math mode="inline" tex="\nabla^{2}f(x_{0})" xml:id="oai:arXiv.org:cs0101001.I1.i7.p1.m1"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="3"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="3"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok></XMath></Math> from the compressed Hessian matrix
<Math mode="inline" tex="\nabla^{2}f(x_{0})V" xml:id="oai:arXiv.org:cs0101001.I1.i7.p1.m2"><XMath><XMTok name="nabla" role="OPERATOR">∇</XMTok><XMApp role="POSTSUPERSCRIPT" scriptpos="3"><XMArg rule="Superscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="OPEN">(</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="3"><XMArg rule="Subscript"><XMTok meaning="0" role="NUMBER">0</XMTok></XMArg></XMApp><XMTok role="CLOSE">)</XMTok><XMTok role="UNKNOWN" font="italic">V</XMTok></XMath></Math>.</p>
          </para>
        </item>
      </itemize>
      <caption>Computing the Hessian matrix for a partially separable function.</caption>
    </para>
    <para xml:id="oai:arXiv.org:cs0101001.S4.p13">
      <p>We consider both direct and substitution methods to determine
the Hessian matrix from the compressed Hessian.
In both cases we are interested in the
ratio <Math mode="inline" tex="\kappa _{2}" xml:id="oai:arXiv.org:cs0101001.S4.p13.m1"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp></XMath></Math>, where</p>
      <equation xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.Ex14">
        <Math mode="display" tex="T\left\{\nabla^{2}f(x)\right\}=\kappa _{2}\mbox{$\rho _{{\scriptscriptstyle M}}^{2}$}T\{ f(x)\}," xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.Ex14.m1">
          <XMath>
            <XMTok role="UNKNOWN" font="italic">T</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok name="nabla" role="OPERATOR">∇</XMTok>
            <XMApp role="POSTSUPERSCRIPT" scriptpos="3">
              <XMArg rule="Superscript">
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMArg>
            </XMApp>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok>
            <XMApp role="POSTSUBSCRIPT" scriptpos="2">
              <XMArg rule="Subscript">
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMArg>
            </XMApp>
            <XMText>
              <text>
                <Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}^{2}" xml:id="oai\@colon arXiv.org\@colon cs0101001.S4.Ex14.m1.m1">
                  <XMath>
                    <XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok>
                    <XMApp role="POSTSUBSCRIPT" scriptpos="4">
                      <XMArg rule="Subscript">
                        <XMTok role="UNKNOWN" font="italic">M</XMTok>
                      </XMArg>
                    </XMApp>
                    <XMApp role="POSTSUPERSCRIPT" scriptpos="4">
                      <XMArg rule="Superscript">
                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                      </XMArg>
                    </XMApp>
                  </XMath>
                </Math>
              </text>
            </XMText>
            <XMTok role="UNKNOWN" font="italic">T</XMTok>
            <XMTok role="OPEN" font="italic">{</XMTok>
            <XMTok role="UNKNOWN" font="italic">f</XMTok>
            <XMTok role="OPEN">(</XMTok>
            <XMTok role="UNKNOWN" font="italic">x</XMTok>
            <XMTok role="CLOSE">)</XMTok>
            <XMTok role="CLOSE" font="italic">}</XMTok>
            <XMTok role="PUNCT">,</XMTok>
          </XMath>
        </Math>
      </equation>
      <p>since this provides a measure of the cost of evaluating
the Hessian matrix relative to the cost of the function.
The <Math mode="inline" tex="\kappa _{2}" xml:id="oai:arXiv.org:cs0101001.S4.p13.m2"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp></XMath></Math> quartiles for both direct and
substitution methods  on the <text><text font="sansserif" size="footnote">MINPACK-2</text></text> problems
used in Section <ref labelref="LABEL:sec:gradients"/>
appear in Table <ref labelref="LABEL:hessians:table"/>.</p>
    </para>
    <table placement="ht" refnum="4.3" xml:id="oai:arXiv.org:cs0101001.S4.T3" labels="LABEL:hessians:table">
      <!-- %**** cs0101001/ad.tex Line 875 **** -->
      <caption>Quartiles for <Math mode="inline" tex="\kappa _{2}" xml:id="oai:arXiv.org:cs0101001.S4.T3.m1"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="3"><XMArg rule="Subscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp></XMath></Math> on
<text font="sansserif">MINPACK-2</text> problems</caption>
      <tabular class="centering">
        <thead>
          <tr>
            <td align="right" thead="true">Method</td>
            <td align="center" thead="true">
              <Math mode="inline" tex="\min" xml:id="oai:arXiv.org:cs0101001.S4.T3.m2">
                <XMath>
                  <XMTok meaning="minimum" role="LIMITOP" scriptpos="post">min</XMTok>
                </XMath>
              </Math>
            </td>
            <td align="center" thead="true">
              <Math mode="inline" tex="q_{1}" xml:id="oai:arXiv.org:cs0101001.S4.T3.m3">
                <XMath>
                  <XMTok role="UNKNOWN" font="italic">q</XMTok>
                  <XMApp role="POSTSUBSCRIPT" scriptpos="10">
                    <XMArg rule="Subscript">
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMArg>
                  </XMApp>
                </XMath>
              </Math>
            </td>
            <td align="center" thead="true">
              <Math mode="inline" tex="q_{2}" xml:id="oai:arXiv.org:cs0101001.S4.T3.m4">
                <XMath>
                  <XMTok role="UNKNOWN" font="italic">q</XMTok>
                  <XMApp role="POSTSUBSCRIPT" scriptpos="10">
                    <XMArg rule="Subscript">
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                    </XMArg>
                  </XMApp>
                </XMath>
              </Math>
            </td>
            <td align="center" thead="true">
              <Math mode="inline" tex="q_{3}" xml:id="oai:arXiv.org:cs0101001.S4.T3.m5">
                <XMath>
                  <XMTok role="UNKNOWN" font="italic">q</XMTok>
                  <XMApp role="POSTSUBSCRIPT" scriptpos="10">
                    <XMArg rule="Subscript">
                      <XMTok meaning="3" role="NUMBER">3</XMTok>
                    </XMArg>
                  </XMApp>
                </XMath>
              </Math>
            </td>
            <td align="center" thead="true">
              <Math mode="inline" tex="\max" xml:id="oai:arXiv.org:cs0101001.S4.T3.m6">
                <XMath>
                  <XMTok meaning="maximum" role="LIMITOP" scriptpos="post">max</XMTok>
                </XMath>
              </Math>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="right" border="t">Direct</td>
            <td align="center" border="t">1.6</td>
            <td align="center" border="t">5.1</td>
            <td align="center" border="t">11.2</td>
            <td align="center" border="t">15.2</td>
            <td align="center" border="t">46.4</td>
          </tr>
          <tr>
            <td align="right" border="b t">Subsitution</td>
            <td align="center" border="b t">1.5</td>
            <td align="center" border="b t">4.1</td>
            <td align="center" border="b t">9.0</td>
            <td align="center" border="b t">12.5</td>
            <td align="center" border="b t">30.2</td>
          </tr>
        </tbody>
      </tabular>
    </table>
    <para xml:id="oai:arXiv.org:cs0101001.S4.p14">
      <p>Direct and substitution methods usually require
more than <text><Math mode="inline" tex="\rho _{{\scriptscriptstyle M}}" xml:id="oai:arXiv.org:cs0101001.S4.p14.m1.m1"><XMath><XMTok name="rho" role="UNKNOWN" font="italic">ρ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="4"><XMArg rule="Subscript"><XMTok role="UNKNOWN" font="italic">M</XMTok></XMArg></XMApp></XMath></Math></text> gradient evaluations to determine
the Hessian matrix, and thus the increase in the value of
<Math mode="inline" tex="\kappa _{2}" xml:id="oai:arXiv.org:cs0101001.S4.p14.m2"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp></XMath></Math> relative to <Math mode="inline" tex="\kappa _{1}" xml:id="oai:arXiv.org:cs0101001.S4.p14.m3"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="1" role="NUMBER">1</XMTok></XMArg></XMApp></XMath></Math> in Table <ref labelref="LABEL:grads:table"/>
was expected.
Still, it is reassuring that the median value of <Math mode="inline" tex="\kappa _{2}" xml:id="oai:arXiv.org:cs0101001.S4.p14.m4"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp></XMath></Math> is reasonably small.
The largest values of <Math mode="inline" tex="\kappa _{2}" xml:id="oai:arXiv.org:cs0101001.S4.p14.m5"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp></XMath></Math> are due to one of the problems; if
this problem is eliminated, then the maximal value drops by at least a factor of two.
In general, problems with the
longest computing times yield the smallest values of <Math mode="inline" tex="\kappa _{2}" xml:id="oai:arXiv.org:cs0101001.S4.p14.m6"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp></XMath></Math>
since these problems tend to mask the overhead in the automatic
differentiation tools and in determining the Hessian matrix.
<!-- %**** cs0101001/ad.tex Line 900 **** -->Moreover, these results are based on using
a gradient evaluation that relies on sparse
automatic differentiation tools; the use of the
hybrid approach mentioned in Section <ref labelref="LABEL:sec:gradients"/>
should reduce <Math mode="inline" tex="\kappa _{2}" xml:id="oai:arXiv.org:cs0101001.S4.p14.m7"><XMath><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMApp role="POSTSUBSCRIPT" scriptpos="2"><XMArg rule="Subscript"><XMTok meaning="2" role="NUMBER">2</XMTok></XMArg></XMApp></XMath></Math> substantially.</p>
    </para>
  </section>
  <section xml:id="oai:arXiv.org:cs0101001.Sx1" labels="LABEL:acks">
    <title>Acknowledgments</title>
    <para xml:id="oai:arXiv.org:cs0101001.Sx1.p1">
      <p>Paul Hovland merits special mention for sharing
his considerable knowledge of automatic differentiation tools.
Liz Dolan used a preliminary implementation of the techniques
in this paper to install <text><text font="sansserif" size="footnote">TRON</text></text> on the NEOS Server, and in the
process sharpened these techniques.
Gail Pieper provided the final touches on the paper with her
careful editing.
<!-- %\input{impact} --></p>
    </para>
  </section>
  <bibliography files="ad2k" xml:id="oai:arXiv.org:cs0101001.bib"/>
</document>
